/*!
 * 
 *     This file is part of the RHC Office project.
 *     Copyright (c) 2019-2023 NTKO.com
 *     Author:  xiawb <xiawb@ntko.com>
 *     Version:  1.1.10
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.OfficeSDK=t():e.OfficeSDK=t()}(self,(()=>(()=>{"use strict";var e={1:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(144);e.exports=i},144:e=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var t=Object.prototype.hasOwnProperty;e.exports=function(e,n){return null!=e&&t.call(e,n)}},761:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(56);e.exports=i},56:e=>{e.exports=
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function(){return"function"==typeof Symbol&&"symbol"==typeof Symbol("foo")}},467:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(550);e.exports=i},550:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(761)();e.exports=function(){return i&&"symbol"==typeof Symbol.toStringTag}},839:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(834);e.exports=i},834:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(503),o="function"==typeof Uint8Array;e.exports=function(e){return o&&e instanceof Uint8Array||"[object Uint8Array]"===i(e)}},591:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(458);e.exports=i},458:e=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var t="function"==typeof Symbol?Symbol:void 0;e.exports=t},503:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i,o=n(467),r=n(498),a=n(12);i=o()?a:r,e.exports=i},498:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(631);e.exports=function(e){return i.call(e)}},12:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(1),o=n(351),r=n(631);e.exports=function(e){var t,n,a;if(null==e)return r.call(e);n=e[o],t=i(e,o);try{e[o]=void 0}catch(t){return r.call(e)}return a=r.call(e),t?e[o]=n:delete e[o],a}},631:e=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var t=Object.prototype.toString;e.exports=t},351:(e,t,n)=>{
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var i=n(591),o="function"==typeof i?i.toStringTag:"";e.exports=o}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.u=e=>"document-viewer.worker.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var o=i.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=i[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href;var i={};return(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function o(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,n||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:String(n)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(i),n.d(i,{AnnotationQueryParams:()=>l,DigitalAnnotationInfo:()=>s,DigitalAnnotationOptions:()=>h,DigitalSignOptions:()=>ee,DigitalSignatureInfo:()=>we,DocumentSDK:()=>yn,FileUploadOptions:()=>Te,IKeystoreConfig:()=>D,KVField:()=>M,KeyboardSignatureOptions:()=>S,Keystore:()=>A,RHCOfficeViewerInternalMessage:()=>g,SDKLogger:()=>hn,SignServerAuthorization:()=>oe,SignatureField:()=>de,StampNote:()=>Ee,WEBAPP_BUNDLE_NAME:()=>He,WEBAPP_VERSION_NAME:()=>qe,Watermark:()=>Fe,WatermarkImageStyle:()=>Le,WatermarkTextStyle:()=>Ke,createNewDocumentSdk:()=>kn,globalDocumentSDKInstanceCallback:()=>Ge,globalDocumentSDKInstances:()=>ze,initializeOfficeWorker:()=>wn,newAnnotationQueryParams:()=>Sn,registerSDKInstanceCallback:()=>$e,registerSDKInstances:()=>Ye,removeSDKInstances:()=>Xe});var s=o((function e(t,n,i,o,r,s,l){a(this,e),this.author=t,this.customData=n,this.digest=i,this.creationDate=o,this.pageIndex=r,this.pageX=s,this.pageY=l})),l=function(){function e(t,n,i,o,r,s,l,u,c,f,d,h,y,p,v,g,b){a(this,e),this.batchId=t,this.batchIdSet=n,this.author=i,this.authorNull=o,this.userName=r,this.userNameNull=s,this.userId=l,this.userIdNull=u,this.customData=c,this.customDataNull=f,this.pageIndex=d,this.pageRange=h,this.subject=y,this.locked=p,this.creationDateBefore=v,this.creationDateAfter=g,this.creationDateEquals=b}return o(e,[{key:"parseSKQueryParams",value:function(e){try{var t=JSON.parse(e);if(t){if(t.userid&&this.userIdEquals(t.userid),t.annotid&&this.batchIdEquals(t.annotid),t.datatag&&this.customDataEquals(t.datatag),t.pageindex&&"all"!==t.pageindex)if("string"==typeof t.pageindex&&t.pageindex.includes("-")){var n=t.pageindex.split("-"),i=parseInt(n[0])-1,o=parseInt(n[1])-1;this.pageRangeEquals(i,o)}else this.pageIndexEquals(parseInt(t.pageindex));(t.type||t.annottype)&&this.subjectEquals(this.convertSKAnnotationTypeToSubject(t.type||t.annottype))}}catch(t){console.error("解析查询参数失败: ",{query:e})}}},{key:"convertSKAnnotationTypeToSubject",value:function(e){return"FreeText"===e?"TextAnnotation":"InkAnnotation"}},{key:"subjectEquals",value:function(e){return this.subject=e,this}},{key:"batchIdEquals",value:function(e){return this.batchId=e,this}},{key:"batchIdInSet",value:function(e){return this.batchIdSet=e,this}},{key:"authorEquals",value:function(e){return this.author=e,this}},{key:"authorIsNull",value:function(){return this.authorNull="undefined",this}},{key:"authorIsNotNull",value:function(){return this.authorNull="defined",this}},{key:"userNameEquals",value:function(e){return this.userName=e,this}},{key:"userNameIsNull",value:function(){return this.userNameNull="undefined",this}},{key:"userNameIsNotNull",value:function(){return this.userNameNull="defined",this}},{key:"userIdEquals",value:function(e){return this.userId=e,this}},{key:"userIdIsNull",value:function(){return this.userIdNull="undefined",this}},{key:"userIdIsNotNull",value:function(){return this.userIdNull="defined",this}},{key:"customDataEquals",value:function(e){return this.customData=e,this}},{key:"customDataIsNull",value:function(){return this.customDataNull="undefined",this}},{key:"customDataIsNotNull",value:function(){return this.customDataNull="defined",this}},{key:"pageIndexEquals",value:function(e){return this.pageIndex=e,this}},{key:"pageRangeEquals",value:function(e,t){return this.pageRange=[e,t],this}},{key:"isLocked",value:function(){return this.locked=!0,this}},{key:"isNotLocked",value:function(){return this.locked=!1,this}},{key:"creationDateIsBefore",value:function(e){return this.creationDateBefore=e,this}},{key:"creationDateIsAfter",value:function(e){return this.creationDateAfter=e,this}},{key:"creationDateIsEquals",value:function(e){return this.creationDateEquals=e,this}}]),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d(i.key),i)}}function f(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:String(t)}var h=f((function e(t,n,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.author=t,this.customData=n,this.penColor=i,this.penWidth=o}));function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,v(i.key),i)}}function v(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=y(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:String(t)}var g=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event=t,this.binder=n,this.payload=i}var t,n,i;return t=e,i=[{key:"obtain",value:function(t,n,i){var o="*";return"function"==typeof t.getBinder&&(o=t.getBinder()),new e(n,o,i)}}],(n=[{key:"getBinder",value:function(){return this.binder}},{key:"getEvent",value:function(){return this.event}},{key:"getPayload",value:function(){return this.payload}}])&&p(t.prototype,n),i&&p(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,k(i.key),i)}}function k(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=b(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:String(t)}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textColor="red",this.textSize=18,this.textFont="Arial"}var t,n,i;return t=e,(n=[{key:"getTextColor",value:function(){return this.textColor}},{key:"getTextFont",value:function(){return this.textFont}},{key:"getTextSize",value:function(){return this.textSize}},{key:"setTextColor",value:function(e){this.textColor=e}},{key:"setTextFont",value:function(e){this.textFont=e}},{key:"setTextSize",value:function(e){this.textSize=e}}])&&m(t.prototype,n),i&&m(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,O(i.key),i)}}function P(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=w(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:String(t)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var D=P((function e(t,n,i,o,r,a){E(this,e),this.cn=t,this.keyIndex=n,this.certificate=i,this.signatureAlgorithm=o,this.deviceProvider=r,this.algorithm=a})),A=function(){function e(t,n){E(this,e),this.keystoreType=t,this.config=n}return P(e,[{key:"getConfig",value:function(){return this.config}},{key:"getType",value:function(){return this.keystoreType}}],[{key:"ofFile",value:function(t){return new e(1,{cn:t})}},{key:"ofDevice",value:function(t,n,i,o,r){return new e(2,{deviceProvider:t,algorithm:n,signatureAlgorithm:i,certificate:o,keyIndex:r})}}]),e}();function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,x(i.key),i)}}function x(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=I(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:String(t)}var M=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t,this.value=n,this.description=i,n&&(this.value=encodeURIComponent(n)),i&&(this.description=encodeURIComponent(i))}var t,n,i;return t=e,(n=[{key:"setDescription",value:function(e){e&&(this.description=encodeURIComponent(e))}},{key:"setFieldName",value:function(e){this.key=e}},{key:"setFieldValue",value:function(e){e&&(this.value=encodeURIComponent(e))}}])&&T(t.prototype,n),i&&T(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();const N={silent:Number.NEGATIVE_INFINITY,fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,ready:3,start:3,box:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},F={silent:{level:-1},fatal:{level:N.fatal},error:{level:N.error},warn:{level:N.warn},log:{level:N.log},info:{level:N.info},success:{level:N.success},fail:{level:N.fail},ready:{level:N.info},start:{level:N.info},box:{level:N.info},debug:{level:N.debug},trace:{level:N.trace},verbose:{level:N.verbose}};function R(e){return null!==e&&"object"==typeof e}function B(e,t,n=".",i){if(!R(t))return B(e,{},n,i);const o=Object.assign({},t);for(const t in e){if("__proto__"===t||"constructor"===t)continue;const r=e[t];null!=r&&(i&&i(o,t,r,n)||(Array.isArray(r)&&Array.isArray(o[t])?o[t]=[...r,...o[t]]:R(r)&&R(o[t])?o[t]=B(r,o[t],(n?`${n}.`:"")+t.toString(),i):o[t]=r))}return o}const j=(...e)=>e.reduce(((e,t)=>B(e,t,"",_)),{});var _;function L(e){return t=e,"[object Object]"===Object.prototype.toString.call(t)&&(!(!e.message&&!e.args)&&!e.stack);var t}let V=!1;const U=[];class W{constructor(e={}){const t=e.types||F;this.options=j({...e,defaults:{...e.defaults},level:K(e.level,t),reporters:[...e.reporters||[]]},{types:F,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const e in t){const n={type:e,...this.options.defaults,...t[e]};this[e]=this._wrapLogFn(n),this[e].raw=this._wrapLogFn(n,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(e){this.options.level=K(e,this.options.types,this.options.level)}prompt(e,t){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(e,t)}create(e){const t=new W({...this.options,...e});return this._mockFn&&t.mockTypes(this._mockFn),t}withDefaults(e){return this.create({...this.options,defaults:{...this.options.defaults,...e}})}withTag(e){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+e:e})}addReporter(e){return this.options.reporters.push(e),this}removeReporter(e){if(e){const t=this.options.reporters.indexOf(e);if(t>=0)return this.options.reporters.splice(t,1)}else this.options.reporters.splice(0);return this}setReporters(e){return this.options.reporters=Array.isArray(e)?e:[e],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const e in this.options.types)console["__"+e]||(console["__"+e]=console[e]),console[e]=this[e].raw}restoreConsole(){for(const e in this.options.types)console["__"+e]&&(console[e]=console["__"+e],delete console["__"+e])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(e,t){e&&(e.__write||(e.__write=e.write),e.write=e=>{this[t].raw(String(e).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(e){e&&e.__write&&(e.write=e.__write,delete e.__write)}pauseLogs(){V=!0}resumeLogs(){V=!1;const e=U.splice(0);for(const t of e)t[0]._logFn(t[1],t[2])}mockTypes(e){const t=e||this.options.mockFn;if(this._mockFn=t,"function"==typeof t)for(const e in this.options.types)this[e]=t(e,this.options.types[e])||this[e],this[e].raw=this[e]}_wrapLogFn(e,t){return(...n)=>{if(!V)return this._logFn(e,n,t);U.push([this,e,n,t])}}_logFn(e,t,n){if((e.level||0)>this.level)return!1;const i={date:new Date,args:[],...e,level:K(e.level,this.options.types)};!n&&1===t.length&&L(t[0])?Object.assign(i,t[0]):i.args=[...t],i.message&&(i.args.unshift(i.message),delete i.message),i.additional&&(Array.isArray(i.additional)||(i.additional=i.additional.split("\n")),i.args.push("\n"+i.additional.join("\n")),delete i.additional),i.type="string"==typeof i.type?i.type.toLowerCase():"log",i.tag="string"==typeof i.tag?i.tag:"";const o=(e=!1)=>{const t=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&t>0){const e=[...this._lastLog.object.args];t>1&&e.push(`(repeated ${t} times)`),this._log({...this._lastLog.object,args:e}),this._lastLog.count=1}e&&(this._lastLog.object=i,this._log(i))};clearTimeout(this._lastLog.timeout);const r=this._lastLog.time&&i.date?i.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=i.date,r<this.options.throttle)try{const e=JSON.stringify([i.type,i.tag,i.args]),t=this._lastLog.serialized===e;if(this._lastLog.serialized=e,t&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin))return void(this._lastLog.timeout=setTimeout(o,this.options.throttle))}catch{}o(!0)}_log(e){for(const t of this.options.reporters)t.log(e,{options:this.options})}}function K(e,t={},n=3){return void 0===e?n:"number"==typeof e?e:t[e]&&void 0!==t[e].level?t[e].level:n}W.prototype.add=W.prototype.addReporter,W.prototype.remove=W.prototype.removeReporter,W.prototype.clear=W.prototype.removeReporter,W.prototype.withScope=W.prototype.withTag,W.prototype.mock=W.prototype.mockTypes,W.prototype.pause=W.prototype.pauseLogs,W.prototype.resume=W.prototype.resumeLogs;class H{constructor(e){this.options={...e},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(e){return e<1?console.__error||console.error:1===e?console.__warn||console.warn:console.__log||console.log}log(e){const t=this._getLogFn(e.level),n="log"===e.type?"":e.type,i=e.tag||"",o=`\n      background: ${this.typeColorMap[e.type]||this.levelColorMap[e.level]||this.defaultColor};\n      border-radius: 0.5em;\n      color: white;\n      font-weight: bold;\n      padding: 2px 0.5em;\n    `,r=`%c${[i,n].filter(Boolean).join(":")}`;"string"==typeof e.args[0]?t(`${r}%c ${e.args[0]}`,o,"",...e.args.slice(1)):t(r,o,...e.args)}}function q(e={}){const t=function(e={}){return new W(e)}({reporters:e.reporters||[new H({})],prompt:(e,t={})=>"confirm"===t.type?Promise.resolve(confirm(e)):Promise.resolve(prompt(e)),...e});return t}q();var z=q({level:5,fancy:!0,formatOptions:{colors:!0,compact:!0}}),G=function(e){return{debug:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=z.withTag(e)).debug.apply(n,[t].concat(o))},trace:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=z.withTag(e)).trace.apply(n,[t].concat(o))},warn:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=z.withTag(e)).warn.apply(n,[t].concat(o))},log:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=z.withTag(e)).log.apply(n,[t].concat(o))},info:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=z.withTag(e)).info.apply(n,[t].concat(o))},error:function(t){for(var n,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=z.withTag(e)).error.apply(n,[t].concat(o))}}},Y=G("OfficeSDK"),X=G("OfficeWorker"),$=G("OfficeClient");function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Z(i.key),i)}}function Z(e){var t=function(e,t){if("object"!=Q(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Q(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Q(t)?t:String(t)}var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.signReason=void 0,this.signLocation=void 0,this.signUserData=void 0,this.keystore=void 0,this.stampNotes=void 0,this.defaultStampPassword=void 0,this.bookmarkName=void 0,this.bookmarkOffsetX=0,this.bookmarkOffsetY=0,this.keywordText=void 0,this.keywordTextFixedPositions=void 0,this.keywordOffsetX=0,this.keywordOffsetY=0,this.signByBookmark=!1,this.signByKeyword=!1,this.signByCoordinate=!1,this.page=void 0,this.pageX=void 0,this.pageY=void 0,this.pageRange=void 0,this.signOnChecked=!1,this.signOnPageSides=!1,this.signTypeOnPageSides=0,this.signPositionOnPageSides=0,this.signOnSearchHighlight=!1,this.fields=[],this.maskSignedCopy=!1,this.maskSignedUploadUrl=void 0,this.grayscaleSealImage=!1,this.requestKeyAuthentication=!1,this.requestSignServerAuthentication=!0,this.signingByCryptoServer=!1,this.signOnChecked=!1,this.signByBookmark=!1,this.signByKeyword=!1,this.signByCoordinate=!1,this.signOnSearchHighlight=!1,this.pageRange=void 0,this.signReason=void 0,this.signLocation=void 0,this.signUserData=void 0,this.defaultStampPassword=void 0,this.bookmarkName=void 0,this.keywordText=void 0,this.stampNotes=[],this.maskSignedCopy=!1}var t,n,i;return t=e,(n=[{key:"disableSignByBookmark",value:function(){this.signByBookmark=!1}},{key:"disableSignByKeywordText",value:function(){this.signByKeyword=!1}},{key:"enableSignByBookmark",value:function(){this.signByBookmark=!0,this.signOnChecked=!1,this.signByKeyword=!1,this.signOnPageSides=!1,this.signByCoordinate=!1,this.signOnSearchHighlight=!1,this.pageRange=void 0}},{key:"enableSignByKeywordText",value:function(){this.signByKeyword=!0,this.signOnChecked=!1,this.signByBookmark=!1,this.signOnPageSides=!1,this.signByCoordinate=!1,this.signOnSearchHighlight=!1,this.pageRange=void 0}},{key:"getBookmarkName",value:function(){return this.bookmarkName}},{key:"getDefaultStampPassword",value:function(){return this.defaultStampPassword}},{key:"setKeystore",value:function(e){this.keystore=e}},{key:"getKeywordText",value:function(){return this.keywordText}},{key:"getSignLocation",value:function(){return this.signLocation}},{key:"getSignReason",value:function(){return this.signReason}},{key:"getSignUserData",value:function(){return this.signUserData}},{key:"addStampNote",value:function(e){this.stampNotes||(this.stampNotes=[]),this.stampNotes.push(e)}},{key:"getStampNotes",value:function(){return this.stampNotes}},{key:"isSignByBookmarkEnabled",value:function(){return this.signByBookmark}},{key:"isSignByKeywordTextEnabled",value:function(){return this.signByKeyword}},{key:"setBookmarkName",value:function(e){this.bookmarkName=e,this.signByBookmark=!0,this.signOnChecked=!1,this.signByKeyword=!1,this.signOnPageSides=!1,this.signByCoordinate=!1,this.signOnSearchHighlight=!1,this.pageRange=void 0}},{key:"setBookmarkOffset",value:function(e,t){this.bookmarkOffsetX=e,this.bookmarkOffsetY=t}},{key:"setDefaultStampPassword",value:function(e){this.defaultStampPassword=e}},{key:"setKeywordText",value:function(e){this.keywordText=e,this.signByKeyword=!0,this.signOnChecked=!1,this.signByBookmark=!1,this.signOnPageSides=!1,this.signByCoordinate=!1,this.signOnSearchHighlight=!1,this.pageRange=void 0}},{key:"addFixedKeywordTextPosition",value:function(e,t,n){this.keywordTextFixedPositions||(this.keywordTextFixedPositions=[]),this.keywordTextFixedPositions.push({pageIndex:e,occurrence:t,position:n})}},{key:"setKeywordTextOffset",value:function(e,t){this.keywordOffsetX=e,this.keywordOffsetY=t}},{key:"setSignLocation",value:function(e){this.signLocation=e}},{key:"setSignReason",value:function(e){this.signReason=e}},{key:"setSignUserData",value:function(e){e&&(this.signUserData=encodeURIComponent(e))}},{key:"enableSignAllPagesByCoordinate",value:function(e,t){this.signOnChecked=!0,this.signByCoordinate=!1,this.signByBookmark=!1,this.signByKeyword=!1,this.signOnPageSides=!1,this.signOnSearchHighlight=!1,this.pageX=e,this.pageY=t}},{key:"enableSignByCoordinate",value:function(e,t,n){this.signByCoordinate=!0,this.signOnChecked=!1,this.signByBookmark=!1,this.signByKeyword=!1,this.signOnPageSides=!1,this.signOnSearchHighlight=!1,this.page=e,this.pageX=t,this.pageY=n}},{key:"getPageRange",value:function(){return this.pageRange}},{key:"setPageRange",value:function(e){this.pageRange=e,this.keywordText=void 0,this.bookmarkName=void 0,this.signOnChecked=!1,this.signByCoordinate=!1,this.signByKeyword=!1,this.signByBookmark=!1,this.signOnPageSides=!1,this.signOnSearchHighlight=!1}},{key:"setupPageSideSign",value:function(){this.pageRange=void 0,this.keywordText=void 0,this.bookmarkName=void 0,this.signOnChecked=!1,this.signByCoordinate=!1,this.signByBookmark=!1,this.signByKeyword=!1,this.signOnSearchHighlight=!1,this.signOnPageSides=!0}},{key:"setSignOnPageSides",value:function(t){t===e.EACH_PAGE_SIDES||t===e.TWO_PAGE_SIDES?(this.setupPageSideSign(),this.signTypeOnPageSides=t):Y.debug("签名类型错误",[{signType:t}])}},{key:"setSignPositionOnPageSides",value:function(e){2===this.signTypeOnPageSides?e>=1&&e<=6?this.signPositionOnPageSides=e:Y.debug("设定单侧骑缝章的位置错误",[{position:e}]):1===this.signTypeOnPageSides?e>=1&&e<=3?this.signPositionOnPageSides=e:Y.debug("设定对称骑缝章的位置错误",[{position:e}]):Y.debug("未设定签名类型为对称骑缝章或单侧骑缝章",[{position:e}])}},{key:"enableSignOnSearchHighlight",value:function(e){this.signOnSearchHighlight=e}},{key:"isSignOnSearchHighlightEnabled",value:function(){return this.signOnSearchHighlight}},{key:"deleteFieldIfExists",value:function(e){for(var t=[],n=0;n<this.fields.length;n++)this.fields[n].key===e&&t.push(n);if(t.length>0)for(var i=0;i<t.length;i++){var o=t[i];this.fields.splice(o,1)}}},{key:"addCustomField",value:function(e){"string"==typeof e.key&&(this.deleteFieldIfExists(e.key),this.fields.push(e))}},{key:"setCustomFields",value:function(e){if(e.length)for(var t=0;t<e.length;t++){var n=e[t];this.addCustomField(n)}}},{key:"disableMaskSignedCopy",value:function(){this.maskSignedCopy=!1,this.maskSignedUploadUrl=void 0}},{key:"enableMaskSignedCopy",value:function(e){this.maskSignedCopy=!0,this.maskSignedUploadUrl=e}},{key:"enableKeyAuthentication",value:function(){this.requestKeyAuthentication=!0}},{key:"disableKeyAuthentication",value:function(){this.requestKeyAuthentication=!1}},{key:"disableSignServerAuthentication",value:function(){this.requestSignServerAuthentication=!1}},{key:"enableCryptoServer",value:function(){this.signingByCryptoServer=!0}},{key:"disableCryptoServer",value:function(){this.signingByCryptoServer=!1}},{key:"enableGrayscaleSealImage",value:function(){this.grayscaleSealImage=!0}},{key:"disableGrayscaleSealImage",value:function(){this.grayscaleSealImage=!1}}])&&J(t.prototype,n),i&&J(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ie(i.key),i)}}function ie(e){var t=function(e,t){if("object"!=te(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=te(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==te(t)?t:String(t)}ee.TWO_PAGE_SIDES=1,ee.EACH_PAGE_SIDES=2,ee.LEFT_TOP_EACH_PAGE=1,ee.LEFT_MIDDLE_EACH_PAGE=2,ee.LEFT_BOTTOM_EACH_PAGE=3,ee.RIGHT_TOP_EACH_PAGE=4,ee.RIGHT_MIDDLE_EACH_PAGE=5,ee.RIGHT_BOTTOM_EACH_PAGE=6,ee.TOP_CROSS_TWO_PAGES=1,ee.MIDDLE_CROSS_TWO_PAGES=2,ee.BOTTOM_CROSS_TWO_PAGES=3,ee.LEFT_BELLOW_STAMP=1,ee.MIDDLE_BELLOW_STAMP=2,ee.RIGHT_BELLOW_STAMP=3;var oe=function(){function e(t,n,i,o,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.status=t,this.login=n,this.token=i,this.userName=o,this.realName=r,this.canDoSign=a}var t,n,i;return t=e,(n=[{key:"canSign",value:function(){return this.canDoSign}},{key:"getLogin",value:function(){return this.login}},{key:"getRealName",value:function(){return this.realName}},{key:"getStatus",value:function(){return this.status}},{key:"getToken",value:function(){return this.token}},{key:"getUserName",value:function(){return this.userName}}])&&ne(t.prototype,n),i&&ne(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,se(i.key),i)}}function se(e){var t=function(e,t){if("object"!=re(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=re(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==re(t)?t:String(t)}function le(e,t,n){return t=ce(t),function(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ue()?Reflect.construct(t,n||[],ce(e).constructor):t.apply(e,n))}function ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ue=function(){return!!e})()}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}var de=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=le(this,t,[].concat(i))).hidden=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(t,e),n=t,o=[{key:"hidden",value:function(){var e=new t;return e.setHidden(!0),e}},{key:"createNew",value:function(){var e=new t;return e.setHidden(!1),e}}],(i=[{key:"setHidden",value:function(e){this.hidden=e}},{key:"isHidden",value:function(){return this.hidden}}])&&ae(n.prototype,i),o&&ae(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(M),he=function(e,t){return e&&void 0!==e[t]},ye=function(e,t){return e&&"number"==typeof e[t]},pe=function(e,t){return e&&"boolean"==typeof e[t]},ve=function(e,t,n){var i=e&&"string"==typeof e[t];return n?i&&!ge(e[t]):i},ge=function(e){return void 0===e||"undefined"===e},be=function(){var e,t;return e=(new Date).getTime(),void 0!==performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){return t=(e+16*Math.random())%16|0,e=Math.floor(e/16),("x"===n?t:3&t|8).toString(16)}))};function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Se(i.key),i)}}function Se(e){var t=function(e,t){if("object"!=me(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=me(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==me(t)?t:String(t)}var we=function(){function e(t,n,i,o,r,a,s,l,u,c,f,d,h,y,p,v,g,b,m,k,S,w,C,P,O,E,D,A,I){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.signSN=t,this.signUNID=n,this.signer=i,this.signName=o,this.signType=r,this.signUser=a,this.signIndex=s,this.signedDate=l,this.licenseName=u,this.certificates=c,this.certificateInfo=f,this.subFilter=d,this.timestampVerified=h,this.signatureCoversWholeDocument=y,this.certificateChainVerified=p,this.certificateSelfSigned=v,this.signatureVerified=g,this.certificateExpired=b,this.certificateValidAtSigningTime=m,this.extInfo=k,this.fields=S,this.lastSignatureEntry=w,this.page=C,this.x=P,this.y=O,this.width=E,this.height=D,this.signUserData=A,this.entries=I}var t,n,i;return t=e,(n=[{key:"fromNTKOSignServerResponse",value:function(e){if(ye(e,"SignIndex")&&(this.signIndex=e.SignIndex),ve(e,"SignUNID")&&(this.signUNID=e.SignUNID),ve(e,"Signer")&&(this.signer=e.Signer),ve(e,"SignName")&&(this.signName=e.SignName),ve(e,"SignUser")&&(this.signUser=e.SignUser),ve(e,"SignedDate")&&(this.signedDate=e.SignedDate),ve(e,"LicenseName")&&(this.licenseName=e.LicenseName),ve(e,"Type")&&(this.signType=e.Type),ve(e,"CertificateInfo")&&(this.certificateInfo=e.CertificateInfo),ve(e,"SubFilter")&&(this.subFilter=e.SubFilter),pe(e,"TimestampVerified")&&(this.timestampVerified=e.TimestampVerified),pe(e,"SignatureCoversWholeDocument")&&(this.signatureCoversWholeDocument=e.SignatureCoversWholeDocument),pe(e,"CertificateChainVerified")&&(this.certificateChainVerified=e.CertificateChainVerified),pe(e,"CertificateSelfSigned")&&(this.certificateSelfSigned=e.CertificateSelfSigned),pe(e,"SignatureVerified")&&(this.signatureVerified=e.SignatureVerified),pe(e,"CertificateExpired")&&(this.certificateExpired=e.CertificateExpired),pe(e,"CertificateValidAtSigningTime")&&(this.certificateValidAtSigningTime=e.CertificateValidAtSigningTime),ye(e,"Page")&&(this.page=e.Page),ye(e,"X")&&(this.x=e.X),ye(e,"Y")&&(this.y=e.Y),ye(e,"Width")&&(this.width=e.Width),ye(e,"Height")&&(this.height=e.Height),he(e,"ExtInfo")){this.extInfo=[];var t=e.ExtInfo;if("object"===me(t)&&void 0!==t.length)for(var n=t.length,i=0;i<n;i++){var o=t[i];if(void 0!==o&&ve(o,"Key")&&ve(o,"Value")&&ve(o,"Description")){var r=new M;r.key=o.Key,r.value=o.Value,r.description=o.Description,this.extInfo.push(r)}}}if(he(e,"Certificates")){this.certificates=[];var a=e.Certificates;if("object"===me(a)&&void 0!==a.length)for(var s=a.length,l=0;l<s;l++){var u=a[l];this.certificates.push(u)}}}}])&&ke(t.prototype,n),i&&ke(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ce(e){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Oe(i.key),i)}}function Oe(e){var t=function(e,t){if("object"!=Ce(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Ce(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ce(t)?t:String(t)}var Ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.content=null,this.fontSize=18,this.contentType=e.TEXT}var t,n,i;return t=e,i=[{key:"ofText",value:function(t,n){var i=new e;return i.fontSize=n||18,i.contentType=e.TEXT,i.content=t,i}},{key:"ofDate",value:function(t){var n=new e;return n.fontSize=t||18,n.contentType=e.DATE,n.content="@Date",n}}],(n=[{key:"getFontSize",value:function(){return this.fontSize}},{key:"getContent",value:function(){return this.content}},{key:"getContentType",value:function(){return this.contentType}}])&&Pe(t.prototype,n),i&&Pe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ie(i.key),i)}}function Ie(e){var t=function(e,t){if("object"!=De(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=De(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==De(t)?t:String(t)}Ee.TEXT=1,Ee.DATE=2;var Te=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uploadURL="",this.uploadURLAvailability=!1}var t,n,i;return t=e,(n=[{key:"checkUrlAvailability",value:function(){return this.uploadURLAvailability=!0,this}},{key:"getUploadUrl",value:function(){return this.uploadURL}},{key:"nocheckUrlAvailability",value:function(){this.uploadURLAvailability=!1}},{key:"setUploadUrl",value:function(e){this.uploadURL=e}}])&&Ae(t.prototype,n),i&&Ae(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Me(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ne(i.key),i)}}function Ne(e){var t=function(e,t){if("object"!=xe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=xe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xe(t)?t:String(t)}var Fe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plain=t,this.fixed=n}var t,n,i;return t=e,(n=[{key:"setText",value:function(e,t){this.plain={text:e,textStyle:t},this.fixed=void 0}},{key:"setImage",value:function(e,t){this.plain={image:e,imageStyle:t},this.fixed=void 0}},{key:"addFixedText",value:function(e,t,n,i,o){this.fixed||(this.fixed=[]),this.fixed.push({page:e,x:t,y:n,text:i,textStyle:o})}},{key:"addFixedImage",value:function(e,t,n,i,o){this.fixed||(this.fixed=[]),this.fixed.push({page:e,x:t,y:n,image:i,imageStyle:o})}}])&&Me(t.prototype,n),i&&Me(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Be(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_e(i.key),i)}}function je(e,t,n){return t&&Be(e.prototype,t),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _e(e){var t=function(e,t){if("object"!=Re(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Re(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Re(t)?t:String(t)}var Le=je((function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.compat=t,this.rotation=n,this.opacity=i}));function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,We(i.key),i)}}function We(e){var t=function(e,t){if("object"!=Ve(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Ve(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ve(t)?t:String(t)}var Ke=function(){function e(t,n,i,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=t,this.color=n,this.compat=i,this.rotation=o,this.opacity=r}var t,n,i;return t=e,(n=[{key:"hex",value:function(e){var t=Object.assign({},this);return e&&e.startsWith("#")&&(t.color=e),t}},{key:"rgb",value:function(e,t,n){var i="number"==typeof e?this.signedRGB(e):0,o="number"==typeof e?this.signedRGB(t):0,r="number"==typeof e?this.signedRGB(n):0,a=Object.assign({},this);return a.color="rgb(".concat(i,",").concat(o,",").concat(r,")"),a}},{key:"rgba",value:function(e,t,n,i){var o="number"==typeof e?this.signedRGB(e):0,r="number"==typeof t?this.signedRGB(t):0,a="number"==typeof n?this.signedRGB(n):0,s="number"==typeof i?this.signedAlpha(i):0,l=Object.assign({},this);return l.color="rgba(".concat(o,",").concat(r,",").concat(a,",").concat(s,")"),l}},{key:"signedRGB",value:function(e){return Math.max(0,Math.min(255,e))}},{key:"signedAlpha",value:function(e){return Math.max(0,Math.min(1,e))}}])&&Ue(t.prototype,n),i&&Ue(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),He="2024.1",qe="6.5.200",ze=[],Ge=[],Ye=function(e){ze.push(e),Ge.forEach((function(t){t(e,"create")}))},Xe=function(e){var t=ze.indexOf(e,0);if(t>=0){var n=ze.splice(t,1);Ge.forEach((function(e){e(n[0],"destroy")}))}},$e=function(e){Ge.push(e)},Qe="CachedFiles",Je=function(e){return e.RAW="RAW",e.PROXY="PROXY",e.THROW="THROW",e.HANDLER="HANDLER",e}({}),Ze=function(e){return e.GET="GET",e.SET="SET",e.APPLY="APPLY",e.CONSTRUCT="CONSTRUCT",e.ENDPOINT="ENDPOINT",e.RELEASE="RELEASE",e}({});function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r,a,s=[],l=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||lt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tt=function(){return!!e})()}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nt(e,t)}function it(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||lt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){at(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e,t,n){var i;return i=function(e,t){if("object"!=ct(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=ct(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==ct(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=lt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function lt(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ct(e){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct(e)}var ft=Symbol("Comlink.proxy"),dt=Symbol("Comlink.endpoint"),ht=Symbol("Comlink.releaseProxy"),yt=Symbol("Comlink.finalizer"),pt=Symbol("Comlink.thrown"),vt=function(e){return"object"===ct(e)&&null!==e||"function"==typeof e},gt=new Map([["proxy",{canHandle:function(e){return vt(e)&&e[ft]},serialize:function(e){var t=new MessageChannel,n=t.port1,i=t.port2;return bt(e,n),[i,[i]]},deserialize:function(e){return e.start(),kt(e)}}],["throw",{canHandle:function(e){return vt(e)&&pt in e},serialize:function(e){var t=e.value;return[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]]},deserialize:function(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function bt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["*"];t.addEventListener("message",(function i(o){if(o&&o.data)if(function(e,t){var n,i=st(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(t===o||"*"===o)return!0;if(o instanceof RegExp&&o.test(t))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}(n,o.origin)){var r,a=rt({path:[]},o.data),s=a.id,l=a.type,u=a.path,c=(o.data.argumentList||[]).map(xt);try{var f=u.slice(0,-1).reduce((function(e,t){return e[t]}),e),d=u.reduce((function(e,t){return e[t]}),e);switch(l){case Ze.GET:r=d;break;case Ze.SET:f[u.slice(-1)[0]]=xt(o.data.value),r=!0;break;case Ze.APPLY:r=d.apply(f,c);break;case Ze.CONSTRUCT:var h=function(e,t,n){if(tt())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var o=new(e.bind.apply(e,i));return n&&nt(o,n.prototype),o}(d,it(c));r=At(h);break;case Ze.ENDPOINT:var y=new MessageChannel,p=y.port1,v=y.port2;bt(e,v),r=function(e,t){return Dt.set(e,t),e}(p,[p]);break;case Ze.RELEASE:r=void 0;break;default:return}}catch(e){r=at({value:e},pt,0)}Promise.resolve(r).catch((function(e){return at({value:e},pt,0)})).then((function(n){var o=et(Tt(n),2),r=o[0],a=o[1];t.postMessage(rt(rt({},r),{},{id:s}),a),l===Ze.RELEASE&&(t.removeEventListener("message",i),mt(t),yt in e&&"function"==typeof e[yt]&&e[yt]())})).catch((function(){var e=et(Tt(at({value:new TypeError("Unserializable return value")},pt,0)),2),n=e[0],i=e[1];t.postMessage(rt(rt({},n),{},{id:s}),i)}))}else console.warn("Invalid origin '".concat(o.origin,"' for comlink proxy"))})),t.start&&t.start()}function mt(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function kt(e,t){return Ot(e,[],t)}function St(e){if(e)throw new Error("Proxy has been released and is not useable")}function wt(e){return Mt(e,{type:Ze.RELEASE}).then((function(){mt(e)}))}var Ct=new WeakMap,Pt="FinalizationRegistry"in globalThis&&new FinalizationRegistry((function(e){var t=(Ct.get(e)||0)-1;Ct.set(e,t),0===t&&wt(e)}));function Ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,i=new Proxy(arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},{get:function(o,r){if(St(n),r===ht)return function(){!function(e){Pt&&Pt.unregister(e)}(i),wt(e),n=!0};if("then"===r){if(0===t.length)return{then:function(){return i}};var a=Mt(e,{type:Ze.GET,path:t.map((function(e){return e.toString()}))}).then(xt);return a.then.bind(a)}return Ot(e,[].concat(it(t),[r]))},set:function(i,o,r){St(n);var a=et(Tt(r),2),s=a[0],l=a[1];return Mt(e,{type:Ze.SET,path:[].concat(it(t),[o]).map((function(e){return e.toString()})),value:s},l).then(xt)},apply:function(i,o,r){St(n);var a=t[t.length-1];if(a===dt)return Mt(e,{type:Ze.ENDPOINT}).then(xt);if("bind"===a)return Ot(e,t.slice(0,-1));var s=et(Et(r),2),l=s[0],u=s[1];return Mt(e,{type:Ze.APPLY,path:t.map((function(e){return e.toString()})),argumentList:l},u).then(xt)},construct:function(i,o){St(n);var r=et(Et(o),2),a=r[0],s=r[1];return Mt(e,{type:Ze.CONSTRUCT,path:t.map((function(e){return e.toString()})),argumentList:a},s).then(xt)}});return function(e,t){var n=(Ct.get(t)||0)+1;Ct.set(t,n),Pt&&Pt.register(e,t,e)}(i,e),i}function Et(e){var t,n=e.map(Tt);return[n.map((function(e){return e[0]})),(t=n.map((function(e){return e[1]})),Array.prototype.concat.apply([],t))]}var Dt=new WeakMap;function At(e){return Object.assign(e,at({},ft,!0))}function It(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return{postMessage:function(t,i){return e.postMessage(t,n,i)},addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function Tt(e){var t,n=st(gt);try{for(n.s();!(t=n.n()).done;){var i=et(t.value,2),o=i[0],r=i[1];if(r.canHandle(e)){var a=et(r.serialize(e),2),s=a[0],l=a[1];return[{type:Je.HANDLER,name:o,value:s},l]}}}catch(e){n.e(e)}finally{n.f()}return[{type:Je.RAW,value:e},Dt.get(e)||[]]}function xt(e){switch(e.type){case Je.HANDLER:return gt.get(e.name).deserialize(e.value);case Je.RAW:return e.value}}function Mt(e,t,n){return new Promise((function(i){var o=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===o&&(e.removeEventListener("message",t),i(n.data))})),e.start&&e.start(),e.postMessage(rt({id:o},t),n)}))}function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function Ft(e){return function(e){if(Array.isArray(e))return Bt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Rt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){if(e){if("string"==typeof e)return Bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bt(e,t):void 0}}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function jt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_t(i.key),i)}}function _t(e){var t=function(e,t){if("object"!=Nt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Nt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nt(t)?t:String(t)}var Lt=function(){function e(t){var n=t.dbName,i=t.version,o=t.tables;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dbName="",this.version=1,this.tableList=[],this.db=null,this.queue=[],this.dbName=n,this.version=i,this.tableList=o}var t,n,i;return t=e,n=[{key:"queryAll",value:function(e){var t=this,n=e.tableName,i=[];return this.commitDb(n,(function(e){return e.openCursor()}),"readonly",(function(e,n){t.handleCursorRun(e,{condition:function(){return!0},handler:function(e){var t=e.currentValue;return i.push(t)},success:function(){return n(i)}})}))}},{key:"query",value:function(e){var t=this,n=e.tableName,i=e.condition,o=[];return this.commitDb(n,(function(e){return e.openCursor()}),"readonly",(function(e,n){t.handleCursorRun(e,{condition:i,handler:function(e){var t=e.currentValue;return o.push(t)},success:function(){return n(o)}})}))}},{key:"count",value:function(e){var t=e.tableName,n=e.key,i=e.countCondition,o={equal:IDBKeyRange.only,gt:IDBKeyRange.lowerBound,lt:IDBKeyRange.upperBound,between:IDBKeyRange.bound};return this.commitDb(t,(function(e){return e.index(n).count(o[i.type].apply(o,Ft(i.rangeValue)))}),"readonly",(function(e,t){t(e.target.result||null)}))}},{key:"queryByKeyValue",value:function(e){var t=e.tableName,n=e.key,i=e.value;return this.commitDb(t,(function(e){return e.index(n).get(i)}),"readonly",(function(e,t){t(e.target.result||null)}))}},{key:"queryByPrimaryKey",value:function(e){var t=e.tableName,n=e.value;return this.commitDb(t,(function(e){return e.get(n)}),"readonly",(function(e,t){t(e.target.result||null)}))}},{key:"update",value:function(e){var t=this,n=e.tableName,i=e.condition,o=e.handle,r=[];return this.commitDb(n,(function(e){return e.openCursor()}),"readwrite",(function(e,n){t.handleCursorRun(e,{condition:i,handler:function(e){var t=e.currentValue,n=e.cursor,i=o(t);r.push(i),n.update(i)},success:function(){n(r)}})}))}},{key:"updateByPrimaryKey",value:function(e){var t=e.tableName,n=e.value,i=e.handle;return this.commitDb(t,(function(e){return e.get(n)}),"readwrite",(function(e,t,n){var o=e.target.result;if(o){var r=i(o);n.put(r),t(r)}else t(null)}))}},{key:"insert",value:function(e){var t=e.tableName,n=e.data;return this.commitDb(t,void 0,"readwrite",(function(e,t,i){n instanceof Array?n.forEach((function(e){return i.put(e)})):i.put(n),t()}))}},{key:"delete",value:function(e){var t=this,n=e.tableName,i=e.condition,o=[];return this.commitDb(n,(function(e){return e.openCursor()}),"readwrite",(function(e,n){t.handleCursorRun(e,{condition:i,handler:function(e){var t=e.currentValue,n=e.cursor;o.push(t),n.delete()},success:function(){n(o)}})}))}},{key:"deleteByPrimaryKey",value:function(e){var t=e.tableName,n=e.value;return this.commitDb(t,(function(e){return e.delete(n)}),"readwrite",(function(e,t){t()}))}},{key:"openDatabase",value:function(){var e=this;return new Promise((function(t,n){var i=window.indexedDB.open(e.dbName,e.version);i.onerror=function(e){n(e)},i.onsuccess=function(n){var i;for(e.db=n.target.result;i=e.queue.shift();)i();t(e)},i.onupgradeneeded=function(t){e.tableList.forEach((function(n){e.createTable(t.target.result,n)}))}}))}},{key:"closeDatabase",value:function(){var t=this;return new Promise((function(n,i){try{if(!t.db)return void n("请开启数据库");t.db.close(),t.db=null,e._instance=null,n(!0)}catch(e){i(e)}}))}},{key:"deleteDatabase",value:function(e){return new Promise((function(t,n){var i=indexedDB.deleteDatabase(e);i.onerror=function(e){n(e)},i.onsuccess=function(e){t(e)}}))}},{key:"deleteTable",value:function(e){return this.commitDb(e,(function(e){return e.clear()}),"readwrite",(function(e,t){t()}))}},{key:"createTable",value:function(e,t){var n=t.tableName,i=t.option,o=t.indexes,r=void 0===o?[]:o;if(!e.objectStoreNames.contains(n)){var a,s=e.createObjectStore(n,i),l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Rt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}(r);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=u.key,f=u.option;s.createIndex(c,c,f)}}catch(e){l.e(e)}finally{l.f()}}}},{key:"commitDb",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"readwrite",o=arguments.length>3?arguments[3]:void 0;return new Promise((function(r,a){var s=function(){try{if(n.db){var s=n.db.transaction(e,i).objectStore(e);if(!t)return void o(null,r,s);var l=t(s);l.onsuccess=function(e){o?o(e,r,s):r(e)},l.onerror=function(e){a(e)}}else a(new Error("请开启数据库"))}catch(e){a(e)}};n.db?s():n.queue.push(s)}))}},{key:"handleCursorRun",value:function(e,t){var n=t.condition,i=t.handler,o=t.success,r=e.target.result;if(r){var a=r.value;n(a)&&i({cursor:r,currentValue:a}),r.continue()}else o()}}],i=[{key:"getInstance",value:function(t){return null===e._instance&&t&&(e._instance=new e(t)),e._instance}}],n&&jt(t.prototype,n),i&&jt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();Lt._instance=null;var Vt=function(){return Lt.getInstance()},Ut=n(839),Wt=n.n(Ut);function Kt(e){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kt(e)}function Ht(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,qt(i.key),i)}}function qt(e){var t=function(e,t){if("object"!=Kt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Kt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Kt(t)?t:String(t)}var zt,Gt,Yt,Xt=function(){function e(t,n,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scriptSrc=t,this.binder=n,this.hotLoading=i,this.autoSync=o,this._innerOfficeSDK=void 0,this._outerOfficeSDK=void 0,this.ready=!1,this.dbReady=!1,this.readyEventListeners=[],this.hostElementView=null,this.shadowRoot=null,this.iframe=null,this.messenger=void 0,this.fileEventListeners=[],this.filePreloadingEntries=[],this.filePreloadEntries=[],this.filePreloadDBCaches=[],this.filePreloadTotalByteLength=0}var t,n,i;return t=e,(n=[{key:"isAutoSync",value:function(){return this.autoSync}},{key:"addEventListener",value:function(e,t){if(t)this.fileEventListeners.push({event:e,callback:function(e){t(e)}});else{var n=this.fileEventListeners.findIndex((function(t){return t.event===e}));-1!==n&&this.fileEventListeners.splice(n,1)}return this}},{key:"create",value:function(e,t){var n=this;if(this.ready=!1,this._outerOfficeSDK=e,"loading"!==document.readyState&&document.body){if(this.hostElementView=document.getElementById("ow@"+this.binder),this.hostElementView)t();else if(this.hostElementView=document.createElement("div"),this.hostElementView.setAttribute("id","ow@"+this.binder),this.hostElementView.setAttribute("style","position: absolute;left: -200px;top: -200px;width: 10px;height: 10px;"),document.body.append(this.hostElementView),this.hostElementView.innerHTML="",this.iframe=document.createElement("iframe"),this.iframe.setAttribute("class","office-worker-shadow"),this.iframe.setAttribute("frameBorder","0"),this.iframe.setAttribute("sandbox","allow-same-origin allow-scripts"),this.shadowRoot=this.hostElementView.attachShadow({mode:"closed"}),this.shadowRoot.appendChild(this.iframe),this.iframe.onload=function(){n.ready=!0,n.messenger=kt(It(n.iframe.contentWindow));var e=Date.now(),i=function(){for(Y.info("缓存数据初始化用时: ",((Date.now()-e)/1e3).toFixed(2)+"秒"),n.dbReady=!0;n.readyEventListeners.length;){var t=n.readyEventListeners.shift();"function"==typeof t&&t()}};n.initializeIndexedDb().then((function(){Vt().queryAll({tableName:Qe}).then((function(e){n.filePreloadTotalByteLength=0,n.filePreloadDBCaches.length=0,e&&e.length&&e.forEach((function(e){e.fileBuffer&&(n.filePreloadTotalByteLength+=e.fileBuffer.byteLength,n.filePreloadDBCaches.push(e.fileId),n.hotLoading&&n.filePreloadEntries.push({request:{fileId:e.fileId,fileUrl:e.fileSource},fileId:e.fileId,fileUrl:e.fileSource,fileBuffer:Wt()(e.fileBuffer)?e.fileBuffer.buffer:e.fileBuffer}))})),i()}),i).catch(i)}));var o=n.iframe.contentWindow.documentSdk;n._innerOfficeSDK=o,o.worker=n,t(o)},this.iframe.onerror=function(){t(),n.ready=!1},this.iframe.contentWindow){var i='<!doctype html><head><title>RHC.OfficeWorker</title><script src="'+this.scriptSrc+'"><\/script></head><body onload="document.attachOfficeWorker()"></body>';this.iframe.contentWindow.document.open(),this.iframe.contentWindow.document.write(i),this.iframe.contentWindow.document.close()}}else document.addEventListener("DOMContentLoaded",(function(){n.create(e,t)}))}},{key:"wrapOnReady",value:function(e){this.ready?e():this.readyEventListeners.push(e)}},{key:"outerOfficeSDK",get:function(){return this._outerOfficeSDK},set:function(e){this._outerOfficeSDK=e}},{key:"innerOfficeSDK",get:function(){return this._innerOfficeSDK}},{key:"preloadFile",value:function(e){var t=this;this.wrapOnReady((function(){t.messenger&&t.messenger.handleWorkerRequestEvent("preloadFile",e).then((function(){t.filePreloadingEntries.push(e)}))}))}},{key:"notifyFileProgressEvent",value:function(e){var t=[];switch(e.type){case"download":t=this.fileEventListeners.filter((function(e){return"onFilePreloadProgress"===e.event}));break;case"upload":t=this.fileEventListeners.filter((function(e){return"onFileUploadProgress"===e.event}))}t&&t.length&&t.forEach((function(t){t.callback(e)}))}},{key:"notifyFilePreloadEvent",value:function(e){var t=this,n=this.filePreloadingEntries.findIndex((function(t){return t.fileId===e.fileId}));n>-1&&this.filePreloadingEntries.splice(n,1),(n=this.filePreloadEntries.findIndex((function(t){return t.fileId===e.fileId})))>-1&&this.filePreloadEntries.splice(n,1),this.filePreloadEntries.push(e);var i=function(n){n||(n="none"),t.postEvent(e.fileId,e.fileUrl,n)};e.request.persist?this.clearFileContent(e.fileId,(function(){Vt().insert({tableName:Qe,data:{fileId:e.fileId,fileSource:e.fileUrl,fileBuffer:e.fileBuffer}}).then((function(){t.filePreloadTotalByteLength+=e.fileBuffer.byteLength,t.filePreloadDBCaches.includes(e.fileId)||t.filePreloadDBCaches.push(e.fileId),i("diskCache")}),(function(){i("inMemory")})).catch((function(){i("inMemory")}))})):i("inMemory")}},{key:"postFileAlreadyCachedEvent",value:function(e){this.filePreloadDBCaches.includes(e.fileId)?this.postEvent(e.fileId,e.fileUrl,"diskCache"):this.postEvent(e.fileId,e.fileUrl,"inMemory")}},{key:"postEvent",value:function(e,t,n){var i="";switch(n){case"inMemory":case"diskCache":i="onFilePreloadComplete";break;case"none":i="onFilePreloadFailed";break;case"Viewer":i="onFileContentSynced"}for(var o=this.fileEventListeners.filter((function(e){return e.event===i}));o.length;){var r=o.shift();r&&r.callback({fileId:e,fileUrl:t,cache:n})}}},{key:"getFileStatus",value:function(e){if(this.filePreloadDBCaches.includes(e))return"cached";var t=this.filePreloadingEntries.findIndex((function(t){return t.fileId===e}));if(t>-1)return"loading";if(t=this.filePreloadEntries.findIndex((function(t){return t.fileId===e})),t>-1){var n=this.filePreloadEntries[t];if(n)return 200===n.statusCode?"cached":"failed"}return"unknown"}},{key:"isFileCachedInMemory",value:function(e){return"cached"===this.getFileStatus(e)&&!this.filePreloadDBCaches.includes(e)}},{key:"isFileCachedOnDisk",value:function(e){return"cached"===this.getFileStatus(e)&&this.filePreloadDBCaches.includes(e)}},{key:"moveToDiskCache",value:function(e){var t=this;if(this.isFileCachedInMemory(e)){var n=this.filePreloadEntries.find((function(t){return t.fileId===e}));if(n)return Vt().insert({tableName:Qe,data:{fileId:e,fileSource:"",fileBuffer:n.fileBuffer}}).then((function(){t.filePreloadTotalByteLength+=n.fileBuffer.byteLength})),!0}return!1}},{key:"syncFileContentFromOfficeViewer",value:function(){var e=this;return new Promise((function(t){e.outerOfficeSDK?e.outerOfficeSDK.getDocumentContent((function(n,i){n&&i?(e.notifyFilePreloadEvent({fileId:n,fileUrl:"",fileBuffer:i,source:"Server",statusCode:200,request:{fileId:n,fileUrl:"",persist:!0,replaceExisting:!0}}),e.postEvent(n,"","Viewer"),t(!0)):t(!1)})):t(!1)}))}},{key:"getFileContent",value:function(e){var t=this;return new Promise((function(n){var i=t.filePreloadEntries.find((function(t){return t.fileId===e}));if(i)n(i.fileBuffer);else if(t.dbReady){var o=Date.now();Vt().query({tableName:Qe,condition:function(t){return t.fileId===e}}).then((function(e){if(Y.info("缓存文件加载用时: ",((Date.now()-o)/1e3).toFixed(2)+"秒"),e.length){var t=e[0].fileBuffer;n(Wt()(t)?t.buffer:t)}else n(void 0)}))}else n(void 0)}))}},{key:"clearFileContent",value:function(e,t){var n=this,i=this.filePreloadEntries.findIndex((function(t){return t.fileId===e}));i>-1&&this.filePreloadEntries.splice(i,1),this.filePreloadDBCaches.includes(e)&&(this.filePreloadDBCaches=this.filePreloadDBCaches.filter((function(t){return t!==e})));var o=function(){Vt().delete({tableName:Qe,condition:function(t){return t.fileId===e}}).then(t,t).catch(t)};Vt().query({tableName:Qe,condition:function(t){return t.fileId===e}}).then((function(e){var t;e.length&&(n.filePreloadTotalByteLength=Math.max(0,n.filePreloadTotalByteLength-((null===(t=e[0].fileBuffer)||void 0===t?void 0:t.byteLength)||0))),o()}),o)}},{key:"getCachedSize",value:function(){return this.filePreloadTotalByteLength}},{key:"uploadFile",value:function(e){var t=this;this.wrapOnReady((function(){t.messenger&&t.messenger.handleWorkerRequestEvent("uploadFile",e).then((function(){}))}))}},{key:"initializeIndexedDb",value:function(){return t=(e={dbName:"RHCPreloadFileStorage",version:1,tables:[{tableName:Qe,option:{keyPath:"id",autoIncrement:!0},indexes:[{key:"id",option:{unique:!0}},{key:"fileId"}]}]}).dbName,n=e.version,i=void 0===n?1:n,o=e.tables,r=void 0===o?[]:o,Lt.getInstance({dbName:t,version:i,tables:r}).openDatabase();var e,t,n,i,o,r}}])&&Ht(t.prototype,n),i&&Ht(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),$t={currentScript:null,detect:function(){for(var e,t=document.scripts,n="rhc-document-viewer-sdk",i=0;i<t.length;){if(e=t[i],/document-viewer\.js/i.test(e.src)){e.hasAttribute(n)||e.setAttribute(n,He+"-"+qe);break}e=null,++i}null!=e&&($t.currentScript=e)}};function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){Zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zt(e,t,n){return(t=dn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function en(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function nn(e){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(e)}function on(e,t,n){return t=an(t),function(e,t){if(t&&("object"===nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sn(e)}(e,rn()?Reflect.construct(t,n||[],an(e).constructor):t.apply(e,n))}function rn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(rn=function(){return!!e})()}function an(e){return an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},an(e)}function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ln(e,t){return ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ln(e,t)}function un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,dn(i.key),i)}}function fn(e,t,n){return t&&cn(e.prototype,t),n&&cn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function dn(e){var t=function(e,t){if("object"!=nn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=nn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nn(t)?t:String(t)}zt=window,Gt="message",Yt=function(e){if(e.data)for(var t=ze.length,n=0;n<t;n++){var i=ze[n];e.data.binder===i.getBinder()&&i.onReceiveContextMessage(e)}},zt.addEventListener?zt.addEventListener(Gt,Yt,!1):zt.attachEvent&&zt.attachEvent("on"+Gt,Yt);var hn=function(){function e(){un(this,e)}return fn(e,[{key:"debug",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];$.debug.apply($,[e].concat(n))}},{key:"trace",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];$.trace.apply($,[e].concat(n))}},{key:"warn",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];$.warn.apply($,[e].concat(n))}},{key:"log",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];$.log.apply($,[e].concat(n))}},{key:"info",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];$.info.apply($,[e].concat(n))}},{key:"error",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];$.error.apply($,[e].concat(n))}}]),e}(),yn=function(e){function t(){var e;return un(this,t),(e=on(this,t)).binder="",e.origin="",e.iframe=null,e.loaded=!1,e.removed=!1,e.documentOpened=!1,e.documentModified=!1,e.digitalSignatures=[],e.annotations=[],e.annotationMode=!1,e.annotationTool="",e.authenticated=!1,e.serverAuthCallback=[],e.readyCallback=[],e.unloadCallback=[],e.docOpenedCallback=[],e.docOpenedByFileIdCallbacks=[],e.docSavedCallback=[],e.docSavedFlightCallbacks=[],e.docClosedCallback=[],e.docClosedFlightCallback=[],e.pageCountCallback=[],e.pageIndexGetCallback=[],e.pageIndexUpdateCallback=[],e.pageModeChangeCallback=[],e.annotationEventCallback=[],e.digitalSignCallback=[],e.digitalSignFlightCallback=[],e.onLoadEkeyCallbackFlightCallback=[],e.onExtensionStateCallbacks=[],e.digitalSignaturesRetrieveCallback=[],e.digitalSignaturesRetrieveFlightCallback=[],e.digitalSignaturesParseCallback=[],e.digitalAnnotationRetrieveCallback=[],e.textAnnotationModifiedCallback=[],e.signServerAuthCallback=[function(t){"object"===nn(t)&&(e.authenticated="ok"===t.status)}],e.signServerAuthOkFlightCallback=void 0,e.pdfFormFieldsCallback=void 0,e.pdfFormFieldsCommitCallback=void 0,e.templateSignMarkupsCallback=void 0,e.viewerEventsCallback=void 0,e.annotationSaveCallback=void 0,e.bookViewActivated=!1,e.bookViewActivatedCallback=void 0,e.fileContentFetchFlightCallback=void 0,e.worker=void 0,e.remoteWorker=void 0,e.hostElementView=null,e.onOfficeWorkerReady=void 0,e.binder=be(),Ye(sn(e)),$t.detect(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ln(e,t)}(t,e),fn(t,[{key:"getReaderBundleName",value:function(){return He}},{key:"getReaderVersion",value:function(){return qe}},{key:"getBinder",value:function(){return this.binder}},{key:"getIFrame",value:function(){return this.iframe}},{key:"getOrigin",value:function(){return this.origin}},{key:"isAuthenticatedOnSignServer",value:function(){return this.authenticated}},{key:"isReaderReady",value:function(){return this.loaded}},{key:"isReaderDestroyed",value:function(){return!this.loaded&&this.removed}},{key:"isDocumentOpened",value:function(){return this.loaded&&this.documentOpened}},{key:"enableDebug",value:function(e){var t=g.obtain(this,"EnableDebug",{debug:e});this.postMessage(t)}},{key:"embedReader",value:function(e,t,n){var i=this,o={debug:!1,toolbar:!0,ribbonMenu:!0,ribbonTitle:!0,keepMenu:!1,canOpenNewFile:!0,canPrint:!0,canDownload:!0,singleViewer:!1,language:"zh",theme:"application",viewMode:"View",binder:"",origin:location.protocol+"//"+location.host,apiServer:t};n||(n={});var r=n;if(void 0!==n.officeWorker&&(this.worker=n.officeWorker,this.worker.outerOfficeWorker=this),"boolean"==typeof n.debug&&(o.debug=n.debug),"string"==typeof r.authorizeCallback&&(o.authCallback=r.authorizeCallback),"string"==typeof r.unauthorizedRedirect&&(o.authRedirect=r.unauthorizedRedirect),"string"==typeof n.authCallback&&(o.authCallback=r.authCallback),"string"==typeof n.authRedirect&&(o.authRedirect=r.authRedirect),"boolean"==typeof n.toolbar&&(o.toolbar=n.toolbar),"boolean"==typeof n.ribbonMenu&&(o.ribbonMenu=n.ribbonMenu),"boolean"==typeof n.ribbonTitle&&(o.ribbonTitle=n.ribbonTitle),"boolean"==typeof n.keepMenu&&(o.keepMenu=n.keepMenu),"boolean"==typeof n.canOpenNewFile&&(o.canOpenNewFile=n.canOpenNewFile),"boolean"==typeof n.canPrint&&(o.canPrint=n.canPrint),"boolean"==typeof n.canDownload&&(o.canDownload=n.canDownload),"string"==typeof n.language&&(o.language=n.language),"string"==typeof n.signMode&&["Extension","Server","Default"].includes(n.signMode)?o.signMode=n.signMode:o.signMode="Default",["View","Annotation","DigitalSign"].includes(n.viewMode)?o.viewMode=n.viewMode:o.viewMode="View","string"==typeof n.theme&&n.theme.length>0&&n.theme.replace(/\s/g,"").length>0&&(o.theme=n.theme),this.hostElementView="string"==typeof e?document.getElementById(e):e,this.hostElementView){this.hostElementView.innerHTML="",o.binder=this.binder;var a=new URL(t);this.origin=a.protocol+"//"+a.host,t.endsWith("/")||(t+="/");var s=t+"?embed="+encodeURIComponent(this.getContainerId(e,o.binder))+"&toolbar="+o.toolbar+"&ribbonMenu="+(o.ribbonMenu?"1":"0")+"&ribbonTitle="+(o.ribbonTitle?"1":"0")+"&keepMenu="+o.keepMenu+"&canPrint="+o.canPrint+"&canDownload="+o.canDownload+"&singleViewer="+o.singleViewer+"&lang="+(o.language?"1":"0")+"&theme="+o.theme+"&viewMode="+o.viewMode+"&signMode="+o.signMode+"&binder="+encodeURIComponent(o.binder)+"&origin="+encodeURIComponent(o.origin)+"&cts="+(""+Math.random()).substring(2);this.iframe=document.createElement("iframe"),this.iframe.setAttribute("src",s),this.iframe.setAttribute("id",this.binder),this.iframe.setAttribute("frameBorder","0"),this.iframe.setAttribute("name","ntko-doc-viewer"),this.iframe.setAttribute("allow","fullscreen"),this.iframe.setAttribute("allowfullscreen","true"),"string"==typeof n.style&&this.iframe.setAttribute("style",n.style),void 0!==n.width?this.iframe.setAttribute("width",n.width):this.iframe.setAttribute("width","100%"),void 0!==n.height?this.iframe.setAttribute("height",n.height):this.iframe.setAttribute("height","100%"),this.hostElementView.appendChild(this.iframe),this.iframe.onload=function(){!function e(){var t=setTimeout((function(){var n;i.loaded?clearTimeout(t):(n=g.obtain(i,"ConfirmWindowLoad",{callback:"OnWebViewerReady",value:{configuration:o,binder:i.binder}}),i.postMessage(n,!1),e(),clearTimeout(t))}),200)}()}}}},{key:"getContainerId",value:function(e,t){if("string"==typeof e)return e;if(e instanceof Element){var n=e.getAttribute("id");if(n)return n}return t}},{key:"removeReader",value:function(){var e=this;if(this.binder){var t=document.getElementById(this.binder);if(t){var n=t.parentNode;n&&n.removeChild(t)}}this.unloadCallback.forEach((function(t){"function"==typeof t&&t.apply(e,[])})),this.iframe=null,this.loaded=!1,this.removed=!0,this.authenticated=!1,this.readyCallback=[],this.unloadCallback=[],this.docOpenedCallback=[],this.pageCountCallback=[],this.pageIndexGetCallback=[],this.pageIndexUpdateCallback=[],this.digitalSignaturesRetrieveCallback=[],this.digitalSignaturesParseCallback=[],this.digitalAnnotationRetrieveCallback=[],this.signServerAuthCallback=[function(t){"object"===nn(t)&&(e.authenticated="ok"===t.status)}],Xe(this)}},{key:"addDocumentServerAuthCallback",value:function(e){this.serverAuthCallback.push(e)}},{key:"addDocumentOpenedCallback",value:function(e){this.docOpenedCallback.push(e)}},{key:"addDocumentSavedCallback",value:function(e){this.docSavedCallback.push(e)}},{key:"addDocumentClosedCallback",value:function(e){this.docClosedCallback.push(e)}},{key:"addPageChangeCallback",value:function(e){this.pageIndexUpdateCallback.push(e)}},{key:"addPageModeChangeCallback",value:function(e){this.pageModeChangeCallback.push(e)}},{key:"addReaderReadyCallback",value:function(e){this.readyCallback.push(e)}},{key:"addReaderUnloadCallback",value:function(e){this.unloadCallback.push(e)}},{key:"setReaderEventListener",value:function(e){this.viewerEventsCallback=e}},{key:"addSignServerAuthCallback",value:function(e){this.signServerAuthCallback.push(e)}},{key:"addDigitalSignatureRetrieveCallback",value:function(e){this.digitalSignaturesRetrieveCallback.push(e)}},{key:"addDigitalSignatureParseCallback",value:function(e){this.digitalSignaturesParseCallback.push(e)}},{key:"addDigitalAnnotationRetrieveCallback",value:function(e){this.digitalAnnotationRetrieveCallback.push(e)}},{key:"addTextAnnotationModifiedCallback",value:function(e){this.textAnnotationModifiedCallback.push(e)}},{key:"openPDFDocument",value:function(e,t){this.openPdfDocument(e,t)}},{key:"openPdfDocument",value:function(e,t){e.fileType="application/pdf",this._openDocument(e,t)}},{key:"openOFDDocument",value:function(e,t){this.openOfdDocument(e,t)}},{key:"openOfdDocument",value:function(e,t){e.fileType="application/ofd",this._openDocument(e,t)}},{key:"openOfficeDocument",value:function(e,t){e.fileType="application/mso",this._openDocument(e,t)}},{key:"_openDocument",value:function(e,t){var n=this;if(e.fileId){var i=function(i){var o={error:i,status:"error",docInfo:{docTitle:e.fileName,docType:e.fileType}};t&&t(o);var r,a=en(n.docOpenedCallback);try{for(a.s();!(r=a.n()).done;){var s=r.value;"function"==typeof s&&s(o.status,i,o.docInfo)}}catch(e){a.e(e)}finally{a.f()}};if(!this.worker)return void i("Invalid worker");var o=0,r=Date.now(),a=this.worker.getFileStatus(e.fileId);switch(Y.info("缓存文件状态: ",{fileId:e.fileId,status:a}),a){case"loading":return void(o=setTimeout((function(){n._openDocument(e,(function(e){t&&t(e),clearTimeout(o)}))}),200));case"failed":case"unknown":return void i("Invalid file cache");case"cached":return void this.worker.getFileContent(e.fileId).then((function(o){o?(Y.info("缓存文件读取用时: ",((Date.now()-r)/1e3).toFixed(2)+"秒"),e.fileCacheId=e.fileId,e.fileContent=o,e.fileId="",n._openDocument(e,t)):i("Invalid file")}))}}else e.fileId=be().split("-").join("").toUpperCase();"string"==typeof e.fileUrl&&(e.fileUrl=decodeURIComponent(e.fileUrl)),"string"==typeof e.uploadUrl&&(e.uploadUrl=decodeURIComponent(e.uploadUrl)),"string"==typeof e.viewMode&&["view","annotation","digital-sign"].includes(e.viewMode)||(e.viewMode="view"),"string"!=typeof e.fileBase64||e.fileBase64.startsWith("data:")||("application/pdf"===e.fileType?e.fileBase64="data:@file/pdf;base64,"+e.fileBase64:"application/ofd"===e.fileType?e.fileBase64="data:@file/ofd;base64,"+e.fileBase64:"application/mso"===e.fileType?e.fileBase64="data:@file/mso;base64,"+e.fileBase64:console.error("不支持通过Base64编码文件流的方式打开此文档",e)),t&&this.docOpenedByFileIdCallbacks.push({fileId:e.fileId,callback:t}),e.timestamp=Date.now();var s=g.obtain(this,"OpenDocument",{callback:"none",value:e});this.postMessage(s)}},{key:"openFromLocalStorage",value:function(){var e=g.obtain(this,"OpenFromLocalStorage",{callback:"none"});this.postMessage(e)}},{key:"closeDocument",value:function(e,t,n){"function"==typeof t&&this.docClosedFlightCallback.push(t);var i=g.obtain(this,"CloseDocument",{callback:"none",value:Jt({discardModify:e},n||{})});this.postMessage(i)}},{key:"setHttpFormFields",value:function(e){var t=g.obtain(this,"ConfigHttpFormField",{callback:"none",value:e});this.postMessage(t)}},{key:"setWatermark",value:function(e){var t=g.obtain(this,"ConfigWatermark",{callback:"none",value:e});this.postMessage(t)}},{key:"setupRibbonMenu",value:function(e){var t=g.obtain(this,"SetupRibbonMenu",{callback:"none",value:{visibility:e}});this.postMessage(t)}},{key:"setupRibbonMenuItem",value:function(e,t,n){var i;"view"===e?i="ViewTab":"annotation"===e?i="AnnotationsTab":"digital-sign"===e&&(i="DigitalSignTab");var o=g.obtain(this,"SetupRibbonMenuItemVisibilities",{callback:"none",value:{tabId:i,visible:t,visibilities:n}});this.postMessage(o)}},{key:"setupRibbonTitleBar",value:function(e){var t=g.obtain(this,"SetupRibbonTitleBar",{callback:"none",value:{visibility:e}});this.postMessage(t)}},{key:"selectRibbonMenu",value:function(e){var t=g.obtain(this,"SelectRibbonMenu",{callback:"none",value:{menuId:e}});this.postMessage(t)}},{key:"rotateCW",value:function(){var e=g.obtain(this,"RotateCW",{callback:"none",value:{}});this.postMessage(e)}},{key:"rotateCCW",value:function(){var e=g.obtain(this,"RotateCCW",{callback:"none",value:{}});this.postMessage(e)}},{key:"invalidateView",value:function(){var e=g.obtain(this,"RequestInvalidate",{callback:"none",value:{}});this.postMessage(e)}},{key:"isDocumentModified",value:function(){return this.documentModified}},{key:"setUploadUrl",value:function(e){var t=g.obtain(this,"ConfigUploadUrl",{callback:"none",value:{uploadUrl:e}});this.postMessage(t)}},{key:"save",value:function(e,t,n){t&&this.docSavedFlightCallbacks.push(t),n||(n={silent:!0});var i=g.obtain(this,"Save",{callback:"none",value:{uploadUrl:e,options:n}});this.postMessage(i)}},{key:"saveAs",value:function(e){var t=g.obtain(this,"SaveAs",{callback:"none",options:e||{}});this.postMessage(t)}},{key:"getDocumentContent",value:function(e){this.fileContentFetchFlightCallback=e;var t=g.obtain(this,"GetFileContent",{callback:"OnGetFileContent",options:{}});this.postMessage(t)}},{key:"print",value:function(){var e=g.obtain(this,"Print",{callback:"none"});this.postMessage(e)}},{key:"setCompactMode",value:function(e){var t=g.obtain(this,"ConfigCompactViewer",{callback:"none",value:e});this.postMessage(t)}},{key:"enterBookViewMode",value:function(e){this.bookViewActivatedCallback=e;var t=g.obtain(this,"ConfigBookViewMode",{callback:"none",value:{active:!0}});this.postMessage(t)}},{key:"exitBookViewMode",value:function(){var e=g.obtain(this,"ConfigBookViewMode",{callback:"none",value:{active:!1}});this.postMessage(e)}},{key:"isBookViewActivated",value:function(){return this.bookViewActivated}},{key:"setLicense",value:function(e,t){console.warn("产品授权已在服务器端配置",{license:e,feature:t})}},{key:"setSignMode",value:function(e){var t=g.obtain(this,"ConfigSignMode",{callback:"none",value:e});this.postMessage(t)}},{key:"setSessionUser",value:function(e){var t={userName:""};"string"==typeof e?t.userName=e:"object"===nn(e)&&(t.userName=e.userName||"",t.userId=e.userId||"");var n=g.obtain(this,"ConfigSessionUser",{callback:"none",value:t});this.postMessage(n)}},{key:"setSessionUserId",value:function(e){var t=g.obtain(this,"ConfigSessionUser",{callback:"none",value:{userId:e}});this.postMessage(t)}},{key:"setSessionData",value:function(e){var t=g.obtain(this,"ConfigSessionData",{callback:"none",value:e});this.postMessage(t)}},{key:"setDefaultKeystorePassword",value:function(e){var t=g.obtain(this,"ConfigDefaultKeystorePKPassword",{callback:"none",value:e});this.postMessage(t)}},{key:"setDefaultStampPassword",value:function(e){this.setDefaultSealPassword(e)}},{key:"setDefaultSealPassword",value:function(e){var t=g.obtain(this,"ConfigDefaultSealPassword",{callback:"none",value:e});this.postMessage(t)}},{key:"setDefaultEKEYPassword",value:function(e){var t=g.obtain(this,"ConfigDefaultEKEYPassword",{callback:"none",value:e});this.postMessage(t)}},{key:"setDefaultEKEYAuthentication",value:function(e){var t=g.obtain(this,"ConfigDefaultEKEYLogin",{callback:"none",value:e});this.postMessage(t)}},{key:"setSignServer",value:function(e){var t=g.obtain(this,"ConfigSignServer",{callback:"none",value:{server:e}});this.postMessage(t)}},{key:"setHttpHeaders",value:function(e){var t=g.obtain(this,"ConfigHttpHeader",{callback:"none",value:e});this.postMessage(t)}},{key:"changeLanguage",value:function(e){if("中文"===e||"汉语"===e?e="zh":"英文"===e||"英语"===e?e="en":"zh"!==e&&"en"!==e&&(e="zh"),"zh"===e||"en"===e){var t=g.obtain(this,"ChangeLanguage",{callback:"none",value:e});this.postMessage(t)}}},{key:"autoFitPage",value:function(){var e=g.obtain(this,"FitPageAuto",{callback:"none",value:{originalSize:!1}});this.postMessage(e)}},{key:"fitPageSize",value:function(){var e=g.obtain(this,"FitPageAuto",{callback:"none",value:{originalSize:!0}});this.postMessage(e)}},{key:"fitPageWidth",value:function(){var e=g.obtain(this,"FitPageWidth",{callback:"none"});this.postMessage(e)}},{key:"fitPageHeight",value:function(){var e=g.obtain(this,"FitPageHeight",{callback:"none"});this.postMessage(e)}},{key:"increasePageScale",value:function(){var e=g.obtain(this,"IncreaseScale",{callback:"none"});this.postMessage(e)}},{key:"decreasePageScale",value:function(){var e=g.obtain(this,"DecreaseScale",{callback:"none"});this.postMessage(e)}},{key:"setPageScale",value:function(e){var t=g.obtain(this,"SetScale",{callback:"none",value:{scale:e}});this.postMessage(t)}},{key:"setPageBlendColor",value:function(e,t,n,i){var o=g.obtain(this,"SetPageBlendColor",{callback:"none",value:{r:e,g:t,b:n,alpha:i}});this.postMessage(o)}},{key:"getPageCount",value:function(e){this.pageCountCallback.push(e);var t=g.obtain(this,"CountPage",{callback:"PageCountCallback"});this.postMessage(t)}},{key:"getPageIndex",value:function(e){this.pageIndexGetCallback.push(e);var t=g.obtain(this,"GetCurrentPage",{callback:"PageIndexCallback"});this.postMessage(t)}},{key:"gotoPage",value:function(e,t,n){var i=g.obtain(this,"GotoPage",{callback:"none",value:{pageIndex:e,x:t,y:n}});this.postMessage(i)}},{key:"gotoNextPage",value:function(){var e=g.obtain(this,"GotoNextPage",{callback:"none"});this.postMessage(e)}},{key:"gotoPreviousPage",value:function(){var e=g.obtain(this,"GotoPreviousPage",{callback:"none"});this.postMessage(e)}},{key:"rotatePage",value:function(e){var t=g.obtain(this,"RotatePage",{callback:"none",value:{rotation:e}});this.postMessage(t)}},{key:"requestFullScreen",value:function(){var e=g.obtain(this,"ActiveFullScreen",{callback:"none",value:{active:!0}});this.postMessage(e)}},{key:"exitFullScreen",value:function(){var e=g.obtain(this,"ActiveFullScreen",{callback:"none",value:{active:!1}});this.postMessage(e)}},{key:"setSinglePageViewMode",value:function(){var e=g.obtain(this,"SetPageViewMode",{callback:"none",value:{mode:"single"}});this.postMessage(e)}},{key:"setTwoPagesViewMode",value:function(){var e=g.obtain(this,"SetPageViewMode",{callback:"none",value:{mode:"double"}});this.postMessage(e)}},{key:"setPageScrollVertical",value:function(){var e=g.obtain(this,"SetPageScrollMode",{callback:"none",value:{mode:"vertical"}});this.postMessage(e)}},{key:"setPageScrollHorizontal",value:function(){var e=g.obtain(this,"SetPageScrollMode",{callback:"none",value:{mode:"horizontal"}});this.postMessage(e)}},{key:"setPageCursorPanDrag",value:function(){var e=g.obtain(this,"SetPageCursorMode",{callback:"none",value:{mode:"pan-drag"}});this.postMessage(e)}},{key:"setPageCursorTextSelect",value:function(){var e=g.obtain(this,"SetPageCursorMode",{callback:"none",value:{mode:"text-select"}});this.postMessage(e)}},{key:"findNext",value:function(e){var t=g.obtain(this,"SearchNext",{callback:"none",value:{queryText:e,showSearchUI:!1}});this.postMessage(t)}},{key:"findPrevious",value:function(e){var t=g.obtain(this,"SearchPrevious",{callback:"none",value:{queryText:e,showSearchUI:!1}});this.postMessage(t)}},{key:"addExtensionStateChangedCallback",value:function(e){this.onExtensionStateCallbacks.push(e)}},{key:"addInkAnnotationCallback",value:function(e){this.addAnnotationEventCallback(e)}},{key:"addAnnotationEventCallback",value:function(e){"function"==typeof e&&this.annotationEventCallback.push(e)}},{key:"openAnnotationView",value:function(e){var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"Open",options:e}});this.postMessage(t)}},{key:"closeAnnotationView",value:function(e){var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"Close",save:e}});this.postMessage(t)}},{key:"openTextAnnotationView",value:function(){this.openAnnotationView({tool:"text"})}},{key:"setTextAnnotationFontColor",value:function(e){var t=g.obtain(this,"SetTextAnnotationFontColor",{callback:"none",value:{color:e}});this.postMessage(t)}},{key:"setTextAnnotationFontSize",value:function(e){var t=g.obtain(this,"SetTextAnnotationFontSize",{callback:"none",value:{size:e}});this.postMessage(t)}},{key:"closeTextAnnotationView",value:function(e){this.closeAnnotationView(e)}},{key:"createTextAnnotation",value:function(e){var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{options:e,action:"CreateTextAnnotation"}});this.postMessage(t)}},{key:"saveAnnotations",value:function(e){e&&(this.annotationSaveCallback=e);var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"Save"}});this.postMessage(t)}},{key:"saveTextAnnotations",value:function(){this.saveAnnotations()}},{key:"clearAnnotations",value:function(){var e=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"Clear"}});this.postMessage(e)}},{key:"clearTextAnnotations",value:function(){this.clearAnnotations()}},{key:"undoAnnotation",value:function(){var e=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"Undo"}});this.postMessage(e)}},{key:"redoAnnotation",value:function(){var e=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"Redo"}});this.postMessage(e)}},{key:"selectAnnotationTool",value:function(e){"eraseLine"===e&&(e="eraser");var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"SelectTool",tool:e}});this.postMessage(t)}},{key:"showAnnotationColorPicker",value:function(){var e=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"ShowColorPicker"}});this.postMessage(e)}},{key:"setAnnotationPenType",value:function(e){this.selectAnnotationTool(e)}},{key:"appendAnnotations",value:function(e){var t=g.obtain(this,"AppendAnnotations",{callback:"none",value:{inkData:e}});this.postMessage(t)}},{key:"setAnnotationPenColor",value:function(e){var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"SetPenColor",penColor:e}});this.postMessage(t)}},{key:"setAnnotationPenWidth",value:function(e){var t=g.obtain(this,"AnnotationOps",{callback:"none",value:{action:"SetPenWidth",penWidth:e}});this.postMessage(t)}},{key:"setAnnotationPenThickness",value:function(e){this.setAnnotationPenWidth(e)}},{key:"enableAnnotationsInfoView",value:function(e){var t=g.obtain(this,"EnableAnnotationsInfoView",{callback:"none",value:{enabled:e,onlyByAuthor:!1}});this.postMessage(t)}},{key:"enableAnnotationsDeletion",value:function(e){var t=g.obtain(this,"EnableAnnotationsDeletion",{callback:"none",value:{enabled:e}});this.postMessage(t)}},{key:"enableAnnotationsDeletionOnlyByAuthor",value:function(e){var t=g.obtain(this,"EnableAnnotationsDeletionOnlyByAuthor",{callback:"none",value:{onlyByAuthor:e}});this.postMessage(t)}},{key:"addDigitalSignCallback",value:function(e){"function"==typeof e&&this.digitalSignCallback.push(e)}},{key:"setupExternalSealServer",value:function(e){if("object"===nn(e)){var t=g.obtain(this,"SetupExternalSealServer",{callback:"none",value:{options:e}});this.postMessage(t)}}},{key:"addDigitalAnnotation",value:function(e){if(e instanceof h){var t=g.obtain(this,"AddDigitalAnnotation",{callback:"none",value:{options:e}});this.postMessage(t)}}},{key:"setDigitalSignOptions",value:function(e){if("object"===nn(e)){var t=g.obtain(this,"SetupDigitalSignOptions",{callback:"none",value:{options:e}});this.postMessage(t)}}},{key:"setExternalDigitalSignOptions",value:function(e){if("object"===nn(e)){var t=g.obtain(this,"SetupExternalDigitalSignOptions",{callback:"none",value:{options:e}});this.postMessage(t)}}},{key:"setPDFDigitalSignCaptionOptions",value:function(e){if("object"===nn(e)){var t=g.obtain(this,"SetupPDFDigitalSignCaptionOptions",{callback:"none",value:{options:e}});this.postMessage(t)}}},{key:"addDigitalSignature",value:function(e,t){if(t&&this.digitalSignFlightCallback.push(t),e){if(e.isSignByBookmarkEnabled()&&"string"!=typeof e.getBookmarkName())return;if(e.isSignByKeywordTextEnabled()&&"string"!=typeof e.getKeywordText())return;"string"!=typeof e.getSignReason()&&e.setSignReason("使用电子签名保护文档");var n=e.isSignOnSearchHighlightEnabled()?"AddDigitalSignatureAtSearchSelection":"AddDigitalSignature",i=g.obtain(this,n,{callback:"none",value:{options:e}});this.postMessage(i)}}},{key:"addDigitalSignatureBySelectedSearchHighlight",value:function(e){e&&(e.enableSignOnSearchHighlight(!0),this.addDigitalSignature(e))}},{key:"listDigitalSignatures",value:function(e){e&&this.digitalSignaturesRetrieveFlightCallback.push(e);var t=g.obtain(this,"ListDigitalSignatures",{callback:"DigitalSignaturesRetrieved"});this.postMessage(t)}},{key:"getDigitalSignatures",value:function(){return this.digitalSignatures}},{key:"getDigitalSignaturesCount",value:function(){return this.digitalSignatures.length}},{key:"enableDigitalSignatureInfoView",value:function(e){var t=g.obtain(this,"EnableDigitalSignatureInfoView",{callback:"none",value:e});this.postMessage(t)}},{key:"enableDigitalSignatureRevocation",value:function(e){var t=g.obtain(this,"EnableDigitalSignatureRevocation",{callback:"none",value:e});this.postMessage(t)}},{key:"listDigitalStamps",value:function(){this.listAnnotations()}},{key:"isInAnnotationMode",value:function(){return this.annotationMode}},{key:"listAnnotations",value:function(){var e=g.obtain(this,"ListAnnotations",{callback:"AnnotationsRetrieved"});this.postMessage(e)}},{key:"getAnnotations",value:function(){return this.annotations}},{key:"getAnnotationsCount",value:function(){return this.annotations.length}},{key:"queryAnnotationsBy",value:function(e){return e?this.annotations.filter((function(t){var n,i,o="undefined"===t.pageIndex;if(e.batchId&&t.batchId!==e.batchId)return!1;if(e.batchIdSet&&(0===e.batchIdSet.length||!e.batchIdSet.includes(t.batchId)))return!1;if(("number"==typeof e.pageIndex||o)&&t.pageIndex!==e.pageIndex)return!1;if(e.pageRange){if(0===e.pageRange.length||o)return!1;if(e.pageRange[0]>t.pageIndex||e.pageRange[1]<t.pageIndex)return!1}if(e.userName&&(null===(n=t.authorInfo)||void 0===n?void 0:n.userName)!==e.userName)return!1;if("string"==typeof e.userNameNull){if("defined"===e.userNameNull&&void 0===t.userName)return!1;if("undefined"===e.userNameNull&&void 0!==t.userName)return!1}if(e.userId&&(null===(i=t.authorInfo)||void 0===i?void 0:i.userId)!==e.userId)return!1;if("string"==typeof e.userIdNull){var r,a;if("defined"===e.userIdNull&&void 0===(null===(r=t.authorInfo)||void 0===r?void 0:r.userId))return!1;if("undefined"===e.userIdNull&&void 0!==(null===(a=t.authorInfo)||void 0===a?void 0:a.userId))return!1}if(e.author&&t.author!==e.author)return!1;if("string"==typeof e.authorNull){if("defined"===e.authorNull&&void 0===t.author)return!1;if("undefined"===e.authorNull&&void 0!==t.author)return!1}if(e.subject&&t.subject!==e.subject)return!1;if(e.customData&&t.customData!==e.customData)return!1;if("string"==typeof e.customDataNull){if("defined"===e.customDataNull&&void 0===t.customData)return!1;if("undefined"===e.customDataNull&&void 0!==t.customData)return!1}var s=new Date(t.creationDate).getTime();return(!e.creationDateEquals||s===e.creationDateEquals.getTime())&&(!(e.creationDateAfter&&s<e.creationDateAfter.getTime())&&!(e.creationDateBefore&&s>e.creationDateBefore.getTime()))})):this.annotations}},{key:"deleteAnnotationsBy",value:function(e,t){var n=this.queryAnnotationsBy(e);if(n.length){var i=g.obtain(this,"AnnotationOps",{value:{action:"Drop",queries:n,prompt:t}});this.postMessage(i)}}},{key:"deleteAnnotationsById",value:function(e,t){var n=(new l).batchIdInSet(e||[]);this.deleteAnnotationsBy(n,t)}},{key:"setSignServerDefaultLogin",value:function(e){this.setDefaultSignServerLogin(e)}},{key:"setDefaultSignServerLogin",value:function(e){var t=g.obtain(this,"ConfigSignServerLogin",{callback:"none",value:e});this.postMessage(t)}},{key:"setSignServerDefaultPassword",value:function(e){this.setDefaultSignServerPassword(e)}},{key:"setDefaultSignServerPassword",value:function(e){var t=g.obtain(this,"ConfigSignServerPassword",{callback:"none",value:e});this.postMessage(t)}},{key:"loginNTKOSignServer",value:function(e,t,n){var i=g.obtain(this,"LoginSignServer",{callback:"OnSignServerAuthentication",value:{serverAddress:e,login:t,password:n}});this.postMessage(i,!1)}},{key:"loginSignServer",value:function(e,t,n,i){this.loginNTKOSignServer(e,t,n),this.signServerAuthOkFlightCallback=i}},{key:"signOutSignServer",value:function(){this.authenticated=!1;var e=g.obtain(this,"SignOutSignServer",{});this.postMessage(e,!1)}},{key:"getPdfFormFiller",value:function(){var e=this,t=function(t,n,i){var o=g.obtain(e,"ApplyPDFFormFill",{callback:"NONE",value:{actionName:t,filedName:n,value:i}});e.postMessage(o,!1)},n=this;return{setTextFieldValue:function(e,n){t("SetTextFieldValue",e,n)},setChoiceFieldValue:function(e,n){t("SetChoiceFieldValue",e,n)},setCheckBoxValue:function(e,n){t("SetCheckBoxValue",e,n)},setRadioButtonValue:function(e,n){t("SetRadioButtonValue",e,n)},commit:function(e){n.pdfFormFieldsCommitCallback=e,t("Commit")},toKeyValue:function(t){var i;i=g.obtain(e,"GetPDFFormFields",{callback:"OnGetPDFFormFields",value:{all:!0}}),e.postMessage(i,!1),n.pdfFormFieldsCallback=t}}}},{key:"getTemplateSignTool",value:function(){var e=this,t=function(t,n,i){var o=g.obtain(e,"ApplyTemplateSignMarkups",{callback:i||"NONE",value:{actionName:t,options:n}});e.postMessage(o,!1)},n=this;return{setup:function(e){t("Setup",Object.assign({fixedSealSize:!1},e||{}))},create:function(){t("Create",{})},getMarkups:function(e){n.templateSignMarkupsCallback=e,t("Retrieve",{},"OnTemplateSignMarkupsRetrieved")},removeMarkup:function(e,n){t("Drop",{markupId:e,prompt:n})},removeAllMarkups:function(e){t("DropAll",{prompt:e})},sign:function(e){e&&n.digitalSignFlightCallback.push(e),t("Sign",{})}}}},{key:"getEkeyTool",value:function(){var e=this,t=this,n=function(t,n,i){var o=g.obtain(e,"ApplyEkeyOps",{callback:i||"NONE",value:{actionName:t,options:n}});e.postMessage(o,!1)};return{setOperationTimeout:function(e){n("SetOperationTimeout",{timeout:e})},isEkeyConnected:function(e){"function"==typeof e&&t.onLoadEkeyCallbackFlightCallback.push(e),n("LoadEkeyList",{},"OnLoadEkeyList")}}}},{key:"getSymbologyTool",value:function(){var e=this;return{createPDF417Barcode:function(t,n,i,o,r,a,s){var l,u,c,f;l="AddPDF417Barcode",u={content:t,pageIndex:n,x:i,y:o,width:r,height:a,margin:s},f=g.obtain(e,"ApplySymbologyOps",{callback:c||"NONE",value:{actionName:l,options:u}}),e.postMessage(f,!1)}}}},{key:"postMessage",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.binder){if(t&&!this.loaded)return void Y.warn("call postMessage failed, iframe not loaded");this.iframe&&this.iframe.contentWindow&&(e.fileContent?this.iframe.contentWindow.postMessage(e,"*",[e.fileContent]):this.iframe.contentWindow.postMessage(e,"*"))}}},{key:"onReceiveContextMessage",value:function(e){var t=this;if(e.data&&e.data.event){var n,i=e.data.event,o=e.data.payload;if("UpgradeMessageBinder"===i)Y.info("Upgrade message binder",[o]),this.binder=o,this.iframe&&this.iframe.setAttribute("id",this.binder);else{if("OnWebViewerReady"===i){if(o.Version!==this.getReaderVersion()&&Y.warn("警告",['阅读器版本("'+o.Version+'")与客户端SDK版本("'+this.getReaderVersion()+'")不一致可能导致调用问题']),!this.loaded){var r;this.loaded=!0,this.documentOpened=!1,this.readyCallback.forEach((function(e){"function"==typeof e&&e.apply(t,[])})),this.readyCallback.length=0;var a=this.onWebViewerReady;"function"==typeof a&&a.apply(this,[o]);var s,l=window;if(null!==(r=l.chrome)&&void 0!==r&&null!==(r=r.webview)&&void 0!==r&&r.hostObjects)null===(s=l.chrome)||void 0===s||null===(s=s.webview)||void 0===s||s.postMessage({functionName:"NtkoH5Reader"})}return}if("OnReaderBeforeUnload"===i)Y.info("On Reader unload",[o]);else if("OnReaderUnload"===i)this.loaded=!1,this.documentOpened=!1,this.unloadCallback.forEach((function(e){"function"==typeof e&&e.apply(t,[])}));else if("DocumentPostCreating"===i)Y.info("Document post creating",[o]);else if("FileDownloadFailed"===i)this.documentOpened=!1,this.docOpenedByFileIdCallbacks&&this.docOpenedByFileIdCallbacks.length&&(this.docOpenedByFileIdCallbacks.map((function(e){return e.callback})).forEach((function(e){e(Object.assign({status:"error"},o.payload||{}))})),this.docOpenedByFileIdCallbacks.length=0);else if("DocumentLoadedWithResult"===i){if(Y.info("Document load with result",[o]),o){var u=o.status,c=o.error||o.details,f=o.docInfo||{};"string"==typeof u&&"ok"===u&&(this.loaded=!0,this.documentOpened=!0);var d,h=en(this.docOpenedCallback);try{for(h.s();!(d=h.n()).done;){var y=d.value;"function"==typeof y&&y(u,c,f)}}catch(e){h.e(e)}finally{h.f()}var p=this.docOpenedByFileIdCallbacks.findIndex((function(e){return e.fileId===f.docId}));p>-1&&this.docOpenedByFileIdCallbacks.splice(p)[0].callback(o)}}else if("DocumentModified"===i){var v;this.documentModified=!(null===(v=o.payload)||void 0===v||!v.modified)}else if("DocumentSaved"===i){if(this.documentModified=!1,this.docSavedFlightCallbacks.length){var g=this.docSavedFlightCallbacks.shift();g&&g(o)}var b,m=en(this.docSavedCallback);try{for(m.s();!(b=m.n()).done;){var k=b.value;"function"==typeof k&&k(o)}}catch(e){m.e(e)}finally{m.f()}}else if("DocumentClosed"===i){if(this.documentOpened=!1,this.docClosedFlightCallback.length){var S=this.docClosedFlightCallback.shift();"function"==typeof S&&S(o)}var w,C=en(this.docClosedCallback);try{for(C.s();!(w=C.n()).done;){var P=w.value;"function"==typeof P&&P(o)}}catch(e){C.e(e)}finally{C.f()}}else if("ExtensionStateChanged"===i){var O,E=!!o.currentValue?"connected":"disconnected",D=en(this.onExtensionStateCallbacks);try{for(D.s();!(O=D.n()).done;){var A=O.value;"function"==typeof A&&A.apply(this,[E])}}catch(e){D.e(e)}finally{D.f()}}else if("OnServerAuthentication"===i){var I;o&&o.credentials&&(I=o.credentials),Y.info("Sign server authentication",[{detail:o}]);var T,x=en(this.serverAuthCallback);try{for(x.s();!(T=x.n()).done;){var M=T.value;"function"==typeof M&&M.apply(this,[I])}}catch(e){x.e(e)}finally{x.f()}}else if("PageCountCallback"===i){var N=this.pageCountCallback.shift();"function"==typeof N&&(Y.info("Page count response",[o]),N.apply(this,[o]))}else if("PageIndexCallback"===i){var F=this.pageIndexGetCallback.shift();"function"==typeof F&&(Y.info("Page index response",[{index:o}]),F.apply(this,[o]))}else if("PageIndexUpdate"===i){var R,B=en(this.pageIndexUpdateCallback);try{for(B.s();!(R=B.n()).done;){var j=R.value;"function"==typeof j&&(Y.info("Page index changed",[{index:o}]),j.apply(this,[o.index,o.count]))}}catch(e){B.e(e)}finally{B.f()}}else if("PageInfoRetrieved"===i){var _,L=en(this.pageIndexUpdateCallback);try{for(L.s();!(_=L.n()).done;){var V=_.value;"function"==typeof V&&V.apply(this,[o.pageIndex+1,o.pageCount])}}catch(e){L.e(e)}finally{L.f()}}else if("PageModeChanged"===i){var U,W=en(this.pageModeChangeCallback);try{for(W.s();!(U=W.n()).done;){var K=U.value;"function"==typeof K&&o&&"number"==typeof o.pageViewMode&&K.apply(this,[o.pageViewMode])}}catch(e){W.e(e)}finally{W.f()}}else if("BookViewModeChanged"===i)this.bookViewActivated=!!o.payload.enabled,this.bookViewActivatedCallback&&this.bookViewActivatedCallback(this.bookViewActivated);else if("OnSignServerAuthentication"===i||"OnSignServerSignOut"===i){var H,q=en(this.signServerAuthCallback);try{for(q.s();!(H=q.n()).done;){var z=H.value;"function"==typeof z&&z.apply(this,[o])}}catch(e){q.e(e)}finally{q.f()}this.signServerAuthOkFlightCallback&&this.signServerAuthOkFlightCallback(o)}else if("DocumentSignedWithResult"===i){if(this.digitalSignFlightCallback.length){var G=this.digitalSignFlightCallback.shift();0===this.digitalSignFlightCallback.length&&G&&G(o.payload)}var X,$=en(this.digitalSignCallback);try{for($.s();!(X=$.n()).done;){var Q=X.value;"function"==typeof Q&&Q.apply(this,[o.payload])}}catch(e){$.e(e)}finally{$.f()}}else if("DigitalSignaturesParsed"===i)this.digitalSignatures=o.signatures||[];else if("DigitalSignaturesRetrieved"===i){var J={},Z=[];if(this.digitalSignatures=o||[],this.digitalSignatures&&this.digitalSignatures.length)for(var ee=this.digitalSignatures.length,te=0;te<ee;te++){var ne=this.digitalSignatures[te],ie=ne.serialNumber||ne.signUNID;ie&&(J[ie]?J[ie].push(ne):J[ie]=[ne])}for(var oe in J)if(Object.prototype.hasOwnProperty.call(J,oe)){var re=J[oe];if(re.length)if(1===re.length)Z.push(re[0]);else{var ae=re,se=ae[0],le=new we;for(var ue in se)Object.prototype.hasOwnProperty.call(se,ue)&&(le[ue]=se[ue]);delete le.signSN,delete le.page,delete le.x,delete le.y,delete le.width,delete le.height,delete le.lastSignatureEntry,delete le.signIndex,delete le.signName,delete le.signType,delete le.signUNID,delete le.signUser,delete le.signUserData,delete le.signatureCoversWholeDocument,delete le.signatureVerified,delete le.subFilter,delete le.timestampVerified,delete le.licenseName,delete le.extInfo,delete le.certificateChainVerified,delete le.certificateExpired,delete le.certificateInfo,delete le.certificateSelfSigned,delete le.certificateValidAtSigningTime,delete le.certificates,le.entries=ae,Z.push(le)}}var ce=function(e){if(e&&e.length){var n,i=en(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;"function"==typeof o&&o.apply(t,[Z])}}catch(e){i.e(e)}finally{i.f()}}};ce(this.digitalSignaturesParseCallback),ce(this.digitalSignaturesRetrieveCallback),ce(this.digitalSignaturesRetrieveFlightCallback),this.digitalSignaturesRetrieveFlightCallback.length=0}else if("AnnotationModeActivated"===i)this.annotationMode=!0,this.annotationEventCallback.forEach((function(e){e.apply(t,["Activated",{}])}));else if("AnnotationModeDeactivated"===i)this.annotationMode=!1,this.annotationEventCallback.forEach((function(e){e.apply(t,["Deactivated",{}])}));else if("AnnotationSaved"===i)this.annotationSaveCallback&&this.annotationSaveCallback(),this.annotationEventCallback.forEach((function(e){e.apply(t,["Saved",{}])}));else if("AnnotationDropped"===i)this.annotationEventCallback.forEach((function(e){e.apply(t,["Dropped",o])}));else if("AnnotationParsed"===i){var fe;this.annotations=(null===(fe=o.payload)||void 0===fe?void 0:fe.annotations)||[],this.annotations.length&&this.annotations.forEach((function(e){delete e.digest,delete e.password,delete e.configData})),this.annotationEventCallback.forEach((function(e){e.apply(t,["Parsed",t.annotations])}))}else if("AnnotationsRetrieved"===i){if(this.annotations=o||[],this.digitalAnnotationRetrieveCallback.length){var de,he=en(this.digitalAnnotationRetrieveCallback);try{for(he.s();!(de=he.n()).done;){var ye=de.value;"function"==typeof ye&&ye.apply(this,[o])}}catch(e){he.e(e)}finally{he.f()}}}else if("AnnotationCleared"===i)this.annotationEventCallback.forEach((function(e){e.apply(t,["Cleared",{}])}));else if("AnnotationModified"===i)this.annotationEventCallback.forEach((function(e){e.apply(t,["StateUpdate",o.payload])}));else if("AnnotationToolChanged"===i){if(o.payload.tool===this.annotationTool)return;this.annotationTool=o.payload.tool,this.annotationEventCallback.forEach((function(e){e.apply(t,["ToolChanged",o.payload])}))}else if("TextAnnotationModified"===i)this.textAnnotationModifiedCallback.forEach((function(e){e.apply(t,["StateUpdate",o])}));else if("TextAnnotationCleared"===i)this.textAnnotationModifiedCallback.forEach((function(e){e.apply(t,["Cleared",o])}));else if("TextAnnotationDisabled"===i)this.textAnnotationModifiedCallback.forEach((function(e){e.apply(t,["Disabled",o])}));else if("OnGetPDFFormFields"===i)"function"==typeof this.pdfFormFieldsCallback&&this.pdfFormFieldsCallback.apply(this,[o]);else if("OnPDFFormFieldsCommit"===i)"function"==typeof this.pdfFormFieldsCommitCallback&&this.pdfFormFieldsCommitCallback.apply(this,[]);else if("OnTemplateSignMarkupsRetrieved"===i)"function"==typeof this.templateSignMarkupsCallback&&this.templateSignMarkupsCallback.apply(this,[o]);else if("OnLoadEkeyList"===i){if(this.onLoadEkeyCallbackFlightCallback.length){var pe=this.onLoadEkeyCallbackFlightCallback.shift();0===this.onLoadEkeyCallbackFlightCallback.length&&pe&&pe(o)}}else if("OnGetFileContent"===i){var ve=o.fileCacheId,ge=o.fileBuffer;this.fileContentFetchFlightCallback&&this.fileContentFetchFlightCallback(ve,ge)}else"FileSaved"===i&&this.worker&&this.worker.isAutoSync()&&this.worker.syncFileContentFromOfficeViewer().then((function(e){e&&Y.info("缓存文件已更新")}))}var be=this[n=i.startsWith("On")||i.startsWith("on")?"on"+i.substring(2):"on"+i.substring(0,1).toUpperCase()+i.substring(1)];"function"==typeof be&&("onExtensionStateChanged"===n?be.apply(this,[o.currentValue?"connected":"disconnected"]):be.apply(this,[o])),this.viewerEventsCallback&&this.viewerEventsCallback(i,o)}}},{key:"handleWorkerRequestEvent",value:function(e,t){var i,o,r=this;if(X.log("Receive work request: ",{event:e,detail:t}),this.remoteWorker||(this.remoteWorker=kt(new Worker(new URL(n.p+n.u(949),n.b)))),this.remoteWorker&&"preloadFile"===e){if("loading"===(o=null===(i=this.worker)||void 0===i?void 0:i.getFileStatus(t.fileId)))return;var a;if("cached"===o&&!t.replaceExisting)return void(null===(a=this.worker)||void 0===a||a.postFileAlreadyCachedEvent(t));this.remoteWorker.preloadFile(t,At((function(e,t){var n;if(t)null===(n=r.worker)||void 0===n||n.notifyFileProgressEvent(t);else if(e){var i;null===(i=r.worker)||void 0===i||i.notifyFilePreloadEvent(e)}})))}}},{key:"createOfficeWorker",value:function(e){var t,n=this,i=(null==e?void 0:e.worker)||(null===(t=$t.currentScript)||void 0===t?void 0:t.src);if(!i)throw"创建OfficeWorker失败: script 未定义";return Y.log("Creating office worker using ",i),this.worker=new Xt(i,this.binder,!(null==e||!e.hotLoading),!(null==e||!e.autoSync)),this.worker.create(this,(function(e){e&&(Y.log("OfficeWorker 已就绪"),n.onOfficeWorkerReady&&n.onOfficeWorkerReady(n.worker))})),this.worker}},{key:"getOfficeWorker",value:function(){return this.worker}}]),t}(hn);function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function vn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,gn(i.key),i)}}function gn(e){var t=function(e,t){if("object"!=pn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=pn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pn(t)?t:String(t)}var bn=function(){function e(t,n,i,o){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.div=t,this.width=n,this.height=i,this.options=o,this.digitalSignatures=[],this.annotations=[],this.docViewerHelper.isReaderReady()?console.warn("阅读器已加载"):(this.docViewerHelper.addReaderReadyCallback((function(){if(o&&o.license){var e=o.license.serialNumber,t=o.license.feature||"VIEW";e&&r.docViewerHelper.setLicense(e,t)}})),this.docViewerHelper.addDocumentOpenedCallback((function(e,t){})),this.docViewerHelper.addDocumentClosedCallback((function(){})),this.docViewerHelper.addDigitalSignatureRetrieveCallback((function(e){"object"===pn(e)&&"number"==typeof e.length&&(0!==e.length?r.digitalSignatures=e:r.digitalSignatures=[])})),this.docViewerHelper.addDigitalAnnotationRetrieveCallback((function(e){"object"===pn(e)&&"number"==typeof e.length&&(0!==e.length?r.annotations=e:r.annotations=[])})))}var t,n,i;return t=e,(n=[{key:"docViewerHelper",get:function(){return document.newDocumentSdk()}},{key:"getPluginVersion",value:function(){return"5.0.5-cacc7953"}},{key:"openFile",value:function(e,t){return!1}},{key:"openFileFromLocalDisk",value:function(e){return!1}},{key:"saveFile",value:function(e,t){return!1}},{key:"printFile",value:function(e,t){throw new Error("Not implemented yet!")}},{key:"closeFile",value:function(){return!1}},{key:"setCompositeVisible",value:function(e,t){throw new Error("Not implemented yet!")}},{key:"setCompositeEnable",value:function(e,t){throw new Error("Not implemented yet!")}},{key:"setViewPreference",value:function(e,t){throw new Error("Not implemented yet!")}},{key:"setZoomRadio",value:function(e){throw new Error("Not implemented yet!")}},{key:"getZoomRadio",value:function(){return 0}},{key:"setUserName",value:function(e){return!1}},{key:"getUserName",value:function(){return""}},{key:"setSealId",value:function(e){throw new Error("Not implemented yet!")}},{key:"setMetaData",value:function(e,t){throw new Error("Not implemented yet!")}},{key:"getMetaData",value:function(e){return""}},{key:"setLogSvrURL",value:function(e){throw new Error("Not implemented yet!")}},{key:"addTrackInfo",value:function(e){throw new Error("Not implemented yet!")}},{key:"clearTrackInfo",value:function(){throw new Error("Not implemented yet!")}},{key:"getTaggedText",value:function(e){return""}},{key:"getLogFilePath",value:function(){return""}}])&&vn(t.prototype,n),i&&vn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),mn=function(e,t,n,i){return new bn(e,t,n,i)},kn=function(){return new yn},Sn=function(){return new l},wn=function(){var e=document.newDocumentSdk();bt(e,It(self.parent)),window.documentSdk=e};window.DocumentSdk=yn,window.DocSignHelper=yn,window.FileUploadOptions=Te,window.KeyboardSignatureOptions=S,window.StampNote=Ee,window.DigitalSignOptions=ee,window.DigitalAnnotationOptions=h,window.SignServerAuthorization=oe,window.KVField=M,window.Watermark=Fe,window.WatermarkTextStyle=Ke,window.WatermarkImageStyle=Le,window.SignatureField=de,window.DigitalAnnotationInfo=s,window.DigitalSignatureInfo=we,window.DocSignInternalMessage=g,window.globalDocumentSDKInstances=ze,window.newDocSignHelper=kn,window.document.newDocSignHelper=kn,window.initializeOfficeWorker=wn,window.OfficeViewerInternalMessage=g,window.newDocumentSdk=kn,window.document.newDocumentSdk=kn,window.document.newAnnotationQueryParams=Sn,window.document.attachOfficeWorker=wn,window.registerRHCOfficeViewerInstanceCallback=$e,window.document.init=mn,window.document.initOFDReader=mn,window.initOFDReader=mn,window.init=mn})(),i})()));
//# sourceMappingURL=document-viewer.js.map